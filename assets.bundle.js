(self.webpackChunkracket_online_ide=self.webpackChunkracket_online_ide||[]).push([[215],{770:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(81),s=n.n(r),i=n(645),a=n.n(i)()(s());a.push([e.id,"html, body {\n  height: 100%;\n  margin: 0;\n}\n\nbody {\n  display: flex;\n  flex-direction: column;\n}\n\n.content {\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n  min-height: 0;\n}\n\n.top {\n  display: flex;\n  flex-direction: row;\n  height: 80%;\n  min-height: 25%;\n}\n\n.main {\n  min-width: 25%;\n  height: 100%;\n  width: 70%;\n}\n\n.tab {\n  height: 100%;\n}\n\n.repl {\n  flex: 1 1 0%;\n  max-width: 30%;\n}\n\n.test-output {\n  flex: 1 1 0%;\n  max-height: 20%;\n}\n\n.resizer[data-direction='horizontal'] {\n  background-color: #cbd5e0;\n  cursor: ew-resize;\n  height: 100%;\n  width: 5px;\n}\n.resizer[data-direction='vertical'] {\n  background-color: #cbd5e0;\n  cursor: ns-resize;\n  height: 5px;\n  width: 100%;\n}\n\n/* CodeMirror */\n\nbody .CodeMirror {\n  height: 100%;\n}\n\n.CodeMirror-hscrollbar {\n  scrollbar-width: none;\n}\n\n.CodeMirror-vscrollbar {\n  scrollbar-width: none;\n}\n\n.cm-s-racket .CodeMirror-selected  {\n  background-color: #0078D7 !important;\n}\n\n.cm-s-racket span span.CodeMirror-selectedtext  {\n  color: white !important;\n}\n\n.cm-s-racket {\n  color: #2626B3;\n}\n\n.cm-s-racket span.cm-boolean {\n  color: #FF9000;\n}\n\n.cm-s-racket span.cm-bracket {\n  color: #0096FF;\n}\n\n.cm-s-racket span.cm-character, .cm-s-racket span.cm-string {\n  color: #00AA00;\n}\n\n.cm-s-racket span.cm-comment {\n  color: #E4B41F;\n}\n\n.cm-s-racket span.cm-error {\n  color: #FF0000;\n}\n\n.cm-s-racket span.cm-keyword, .cm-placeholder {\n  color: #708;\n}\n\n.cm-s-racket span.cm-number {\n  color: #E548FF;\n}\n\n.cm-highlight-error {\n  background: #FFC0CB;\n}\n\n.cm-highlight-unused {\n  background: black;\n  color: #FF7F00 !important;\n}\n\n.cm-highlight-error-message {\n  color: #FF0000 !important;\n}\n\n/* Material Design */\n\n:root {\n  --mdc-theme-primary: #FEDBD0;\n  --mdc-theme-secondary: #FEEAE6;\n}\n\n.mdc-top-app-bar {\n  color: #442C2E;\n}\n\n.mdc-icon-button {\n  color: #442C2E !important;\n}\n\n.mdc-top-app-bar__row {\n  height: 35px;\n}\n\n.mdc-top-app-bar--fixed-adjust {\n  padding-top: 35px;\n}\n",""]);const o=a},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,s,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var o=0;o<this.length;o++){var c=this[o][0];null!=c&&(a[c]=!0)}for(var u=0;u<e.length;u++){var l=[].concat(e[u]);r&&a[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),s&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=s):l[4]="".concat(s)),t.push(l))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},379:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},a=[],o=0;o<e.length;o++){var c=e[o],u=r.base?c[0]+r.base:c[0],l=i[u]||0,d="".concat(u," ").concat(l);i[u]=l+1;var h=n(d),m={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(m);else{var p=s(m,r);r.byIndex=o,t.splice(o,0,{identifier:d,updater:p,references:1})}a.push(d)}return a}function s(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,s){var i=r(e=e||[],s=s||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var o=n(i[a]);t[o].references--}for(var c=r(e,s),u=0;u<i.length;u++){var l=n(i[u]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}i=c}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var s=void 0!==n.layer;s&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,s&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},410:(e,t,n)=>{"use strict";var r=n(379),s=n.n(r),i=n(795),a=n.n(i),o=n(569),c=n.n(o),u=n(565),l=n.n(u),d=n(216),h=n.n(d),m=n(589),p=n.n(m),w=n(770),g={};g.styleTagTransform=p(),g.setAttributes=l(),g.insert=c().bind(null,"head"),g.domAPI=a(),g.insertStyleElement=h(),s()(w.Z,g),w.Z&&w.Z.locals&&w.Z.locals,n(906);var f=n(830);class y{constructor(e){this.marked=!1;const t=document.getElementById(e);this.cm=CodeMirror((e=>{t.parentNode?.replaceChild(e,t)}),{lineNumbers:!0,tabSize:2,mode:"racket",theme:"racket",styleSelectedText:!0,extraKeys:{"Alt-Enter":()=>this.runCode(),"Ctrl-/":()=>this.cm.execCommand("toggleComment")}}),this.cm.on("changes",(()=>this.unmark()))}registerController(e){this.controller=e}mark(e,t){this.marked=!0,this.cm.markText({line:e.startLineno-1,ch:e.startColno},{line:e.endLineno-1,ch:e.endColno},{className:t})}unmark(){this.marked&&(this.cm.doc.getAllMarks().forEach((e=>e.clear())),this.marked=!1)}runCode(){this.unmark(),this.controller.repl.resetRepl(),this.controller.testOutput.resetTestOutput(),window.racket.pipeline.reset(),window.racket.pipeline.setErrorsCallback((e=>{window.racket.pipeline.reset();let t="";for(const n of e)this.mark(n.sourceSpan,"cm-highlight-error"),t+=n.msg+"\n";t+="> ",this.controller.repl.append(t,"cm-highlight-error-message")})),window.racket.pipeline.setUnusedCallback((e=>this.mark(e,"cm-highlight-unused"))),window.racket.pipeline.evaluateCode(this.cm.getValue())}}class v{constructor(e){const t=document.getElementById(e);this.cm=CodeMirror((e=>{t.parentNode?.replaceChild(e,t)}),{lineNumbers:!1,readOnly:!0,value:"Source code at https://github.com/ZibingZhang/racket-online-ide\n\nKeyboard shortcuts\n==================\n\nEditor\n--------------------\nAlt-Enter | Run code\n\nREPL\n---------------------------\nAlt-p | Previous expression\n\nSettings\n----------------------\nCtrl-s | Save settings",mode:"text"})}}class x{constructor(e){this.marked=!1,this.history=[],this.historyIdx=0;const t=document.getElementById(e)||new Element;this.cm=CodeMirror((e=>{t.parentNode?.replaceChild(e,t)}),{lineWrapping:!0,smartIndent:!1,tabSize:2,value:"> ",mode:"racket",theme:"racket",styleSelectedText:!0,extraKeys:{"Alt-P":e=>{--this.historyIdx;const t=this.historyIdx%(this.history.length+1),n=0===t?"":this.history.at(t);this.cm.replaceRange("> "+n,{line:this.cm.lastLine(),ch:0},{line:this.cm.lastLine()})},"Shift-Alt-P":e=>{this.historyIdx-=this.history.length;const t=this.historyIdx%(this.history.length+1),n=0===t?"":this.history.at(t);this.cm.replaceRange("> "+n,{line:this.cm.lastLine(),ch:0},{line:this.cm.lastLine()})}}}),this.cm.getSelectedRange=()=>({from:this.cm.getCursor(!0),to:this.cm.getCursor(!1)}),this.cm.on("change",((e,t)=>{const n=t.origin?.match(/cm-highlight-error-message (\d+)/);if(n){const e=Number(n[1]);for(let t=0;t<e;t++)this.cm.markText({line:this.cm.lastLine()-1-t,ch:0},{line:this.cm.lastLine()-1-t},{className:"cm-highlight-error-message"})}this.marked&&!t.origin?.match("ignore")&&e.doc.getAllMarks().filter((e=>"cm-highlight-error-message"!==e.className)).forEach((e=>e.clear()))})),this.cm.on("keydown",((e,t)=>{switch(t.key){case"Backspace":if(e.somethingSelected()){const n=e.getSelection(),r=e.getSelectedRange();(n.includes("\n")||r.from.line!==e.lineCount()-1||r.from.ch<2)&&t.preventDefault()}else{const n=e.getCursor(),r=e.lineCount();(n.line!==r-1||n.ch<=2)&&t.preventDefault()}break;case"Delete":{const n=e.getCursor();(n.line!==e.lineCount()-1||n.ch<2)&&t.preventDefault();break}case"Enter":{e.setCursor(e.lineCount(),0),t.preventDefault();const n=e.doc.getLine(e.doc.lastLine()).slice(2);this.append("\n"),this.runCode(n),""!==n.trim()&&(this.history.push(n),this.historyIdx=0);break}case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"Control":case"Shift":break;default:{const t=e.getCursor();(t.line!==e.lineCount()-1||t.ch<2)&&e.setCursor(e.lineCount(),0)}}}))}mark(e){this.marked=!0;const t=this.cm.lastLine()-1;this.cm.markText({line:t,ch:e.startColno+2},{line:t,ch:e.endColno+2},{className:"cm-highlight-error"})}runCode(e){window.racket.pipeline.setErrorsCallback((e=>{let t="";for(const n of e)this.mark(n.sourceSpan),t+=n.msg+"\n";t+="> ",this.append(t,"cm-highlight-error-message")})),window.racket.pipeline.setUnusedCallback((()=>{})),window.racket.pipeline.evaluateCode(e)}append(e,t=""){const n=this.cm.lastLine();this.cm.replaceRange(e,CodeMirror.Pos(n),null,`ignore ${t} ${(e.match(/\n/g)||"").length}`),this.cm.scrollIntoView(n)}resetRepl(){this.cm.setValue("")}}class T{constructor(e){this.INIT_VALUE='{\n  "higherOrderFunctions": true,\n  "primitives": {\n    "blackList": [],\n    "relaxedConditions": [\n      "*",\n      "+",\n      "/",\n      "string-append",\n      "string-ci<=?",\n      "string-ci<?",\n      "string-ci=?",\n      "string-ci>=?",\n      "string-ci>?",\n      "string<=?",\n      "string<?",\n      "string=?",\n      "string>=?",\n      "string>?"\n    ]\n  },\n  "stringify": {\n    "abbreviatedList": true\n  },\n  "syntax": {\n    "forms": [\n      "and",\n      "check-error",\n      "check-expect",\n      "check-member-of",\n      "check-random",\n      "check-range",\n      "check-satisfied",\n      "check-within",\n      "cond",\n      "define",\n      "define-struct",\n      "else",\n      "if",\n      "lambda",\n      "letrec",\n      "let*",\n      "let",\n      "local",\n      "or",\n      "quasiquote",\n      "quote",\n      "require",\n      "unquote"\n    ],\n    "lambdaExpression": true,\n    "listAbbreviation": true,\n    "quasiquoting": true\n  }\n}';const t=document.getElementById(e);this.cm=CodeMirror((e=>{t.parentNode?.replaceChild(e,t)}),{lineNumbers:!0,tabSize:2,value:this.INIT_VALUE,mode:"application/json",extraKeys:{"Ctrl-S":()=>this.updateSettings()}})}updateSettings(){try{const e=JSON.parse(this.cm.getValue());if(!Array.isArray(e)&&"object"==typeof e)return window.racket.updateSettings(e),!0}catch(e){}return alert("The settings are not a valid JSON object."),!1}}class b{constructor(e){this.failedTests=0,this.totalTests=0;const t=document.getElementById(e);this.cm=CodeMirror((e=>{t.parentNode?.replaceChild(e,t)}),{lineNumbers:!1,readOnly:!0,tabSize:2,value:"\n\n\n",mode:"text"})}appendToTestOutputLn(e){this.cm.replaceRange(`${e}\n`,CodeMirror.Pos(this.cm.lastLine()))}resetTestOutput(){this.cm.setValue("\n\n\n"),this.failedTests=0,this.totalTests=0}handleTestResults(e){const t=[];for(const n of e)this.totalTests++,n.passed||(this.failedTests++,t.push(n));if(this.totalTests>0){let e;this.cm.replaceRange(`Ran ${this.totalTests} test${this.totalTests>1?"s":""}.`,{line:0,ch:0},{line:0}),e=0===this.failedTests?1===this.totalTests?"The test passed!":2===this.totalTests?"Both test passed!":`All ${this.totalTests} tests passed!`:this.failedTests===this.totalTests?"0 tests passed.":`${this.failedTests} of the ${this.totalTests} tests failed.`,this.cm.replaceRange(e,{line:1,ch:0},{line:1})}this.failedTests>0&&this.failedTests===t.length&&this.appendToTestOutputLn("Check failures:"),t.forEach((e=>this.appendToTestOutputLn(`  ${e.errMsg.replace("\n","\n  ")}\n    at line ${e.sourceSpan.startLineno}, column ${e.sourceSpan.startColno}`)))}}new class{constructor(){this.activeTab=0,this.tabs=new Map,this.editor=new y("editor-textarea"),this.settings=new T("settings-textarea"),this.info=new v("info-textarea"),this.repl=new x("repl-textarea"),this.testOutput=new b("test-output-textarea"),this.editor.registerController(this),this.tabs.set(0,[document.getElementById("editor-tab"),this.editor]),this.tabs.set(1,[document.getElementById("settings-tab"),this.settings]),this.tabs.set(2,[document.getElementById("info-tab"),this.info]),this.editor.cm.focus(),this.settings.updateSettings(),document.getElementById("run-button").onclick=this.editor.runCode.bind(this.editor),document.getElementById("editor-button").onclick=()=>this.switchToTab(0),document.getElementById("settings-button").onclick=()=>this.switchToTab(1),document.getElementById("info-button").onclick=()=>this.switchToTab(2),window.racket.pipeline.setSuccessCallback((e=>{const t=[];for(const n of e)if((0,f.gf)(n))t.push(n);else for(this.repl.append(n.stringify()+"\n");t.length>0;){const e=t.shift();this.repl.cm.addLineWidget(this.repl.cm.lastLine()-1,e.canvas,{above:!0})}for(;t.length>0;){const e=t.shift();this.repl.cm.addLineWidget(this.repl.cm.lastLine(),e.canvas,{above:!0})}this.repl.append("> "),this.repl.cm.scrollIntoView(this.repl.cm.lastLine())})),window.racket.pipeline.setTestResultsCallback(this.testOutput.handleTestResults.bind(this.testOutput))}switchToTab(e){if(1!==this.activeTab||1===e||this.settings.updateSettings()){for(const[t,[n,r]]of this.tabs)t!==e?n.style.display="none":(n.style.removeProperty("display"),r.cm.refresh(),r.cm.focus());this.activeTab=e}}}},223:(e,t,n)=>{"use strict";n.d(t,{q:()=>o});var r=n(1),s=n(34),i=n(870),a=n(432);class o{constructor(e){this.global=new r.x,this.map=new Map,this.parentEnv=e}set(e,t){this.map.set(e,t)}get(e,t){const n=this.map.get(e);if(n)return n;if(this.parentEnv)return this.parentEnv.get(e,t);if(!i.L.primitives.blackList.includes(e)&&this.global.primitiveEnvironment.map.has(e))return this.global.primitiveEnvironment.get(e,t);throw new a.ME((0,s.eX)(e),t)}delete(e){this.map.delete(e)}copy(){const e=new o;for(const t of this.map)e.set(t[0],t[1]);let t=this;for(;t.parentEnv;){t=t.parentEnv;for(const[n,r]of t.map)e.map.has(n)||e.set(n,r)}return e}has(e){return this.map.has(e)||this.parentEnv&&this.parentEnv.has(e)||!i.L.primitives.blackList.includes(e)&&this.global.primitiveEnvironment.map.has(e)}}},625:(e,t,n)=>{"use strict";var r;n.d(t,{j:()=>s,Z:()=>r}),function(e){e.And="and",e.CheckError="check-error",e.CheckExpect="check-expect",e.CheckMemberOf="check-member-of",e.CheckRandom="check-random",e.CheckRange="check-range",e.CheckSatisfied="check-satisfied",e.CheckWithin="check-within",e.Cond="cond",e.Define="define",e.DefineStruct="define-struct",e.Else="else",e.If="if",e.Lambda="lambda",e.Letrec="letrec",e.Letstar="let*",e.Let="let",e.Local="local",e.Or="or",e.Quasiquote="quasiquote",e.Quote="quote",e.Require="require",e.Unquote="unquote"}(r||(r={}));const s=[];for(const e in r)s.push(r.valueOf()[e])},484:(e,t,n)=>{"use strict";n.d(t,{s:()=>c,x:()=>r});var r,s=n(34),i=n(1),a=n(870),o=n(432);class c{constructor(e=!1){this.global=new i.x,this.variables=new Map,this.parentScope=e}set(e,t){this.variables.set(e,t)}get(e,t,n){const r=this.variables.get(e)||this.parentScope&&this.parentScope.get(e,t,n)||!a.L.primitives.blackList.includes(e)&&(a.L.primitives.relaxedConditions.includes(e)&&this.global.primitiveRelaxedScope.variables.has(e)&&this.global.primitiveRelaxedScope.get(e,t,n)||this.global.primitiveScope.variables.has(e)&&this.global.primitiveScope.get(e,t,n));if(!r)throw t?new o.ME((0,s.In)(e),n):new o.ME((0,s.yu)(e),n);return r}has(e){return this.variables.has(e)||this.parentScope&&this.parentScope.has(e)||!a.L.primitives.blackList.includes(e)&&this.global.primitiveScope.variables.has(e)}}!function(e){e.Data="DATA",e.PrimitiveFunction="PRIMITIVE_FUNCTION",e.StructureType="STRUCTURE_TYPE",e.UserDefinedFunction="USER_DEFINED_FUNCTION"}(r||(r={}))},226:(e,t,n)=>{"use strict";n.d(t,{B:()=>r,D:()=>s});const r=s(0,0,0,0);function s(e,t,n,r){return{startLineno:e,startColno:t,endLineno:n,endColno:r}}},432:(e,t,n)=>{"use strict";n.d(t,{ME:()=>r,mf:()=>s,ty:()=>i});class r extends Error{constructor(e,t){super(e),this.msg=e,this.sourceSpan=t}}function s(e,t=[],n=[]){return{output:e,errors:t,tests:n}}function i(e,t,n){return{passed:e,errMsg:t,sourceSpan:n}}},34:(e,t,n)=>{"use strict";n.d(t,{l:()=>a,Iy:()=>o,Cq:()=>c,KW:()=>u,XM:()=>l,yG:()=>d,bB:()=>h,R0:()=>m,v_:()=>p,$h:()=>w,z3:()=>g,gD:()=>f,NS:()=>y,C0:()=>v,He:()=>x,$Z:()=>T,JY:()=>b,ll:()=>E,yQ:()=>k,ON:()=>C,Ax:()=>$,d:()=>S,B:()=>P,fN:()=>A,Mi:()=>B,Kl:()=>F,bU:()=>R,eJ:()=>N,AC:()=>H,YT:()=>M,XK:()=>q,_m:()=>D,WY:()=>L,vL:()=>_,n4:()=>W,a1:()=>I,F6:()=>O,R5:()=>Z,y5:()=>K,HQ:()=>U,Lx:()=>z,Qe:()=>V,Pd:()=>X,tw:()=>G,SY:()=>Y,s5:()=>j,Gl:()=>J,Ci:()=>Q,sH:()=>te,QF:()=>ee,OP:()=>re,Eh:()=>ne,zs:()=>se,jf:()=>ie,Gb:()=>ae,Qb:()=>oe,zO:()=>ce,hd:()=>ue,hp:()=>le,SE:()=>de,gn:()=>he,QM:()=>me,Lf:()=>pe,_M:()=>we,xL:()=>ge,p7:()=>fe,R6:()=>ye,uC:()=>ve,wS:()=>xe,vN:()=>Te,zv:()=>be,ne:()=>Ee,WA:()=>ke,mS:()=>Se,rO:()=>Ce,A6:()=>$e,qR:()=>Ae,C_:()=>Be,An:()=>Pe,fW:()=>Fe,cN:()=>Ne,bf:()=>Re,vV:()=>He,dx:()=>Me,JC:()=>qe,nT:()=>De,yu:()=>Le,In:()=>_e,eX:()=>We,te:()=>Ie,R9:()=>Oe,NJ:()=>Ze,n3:()=>Ke,u:()=>Ue,hC:()=>ze,ss:()=>Xe});var r=n(326),s=n(813);function i(e){if("string"==typeof e)return e.toString();if(!(0,r.F)(e))return"a part";switch(e.token.type){case s.i.True:case s.i.False:return"a boolean";case s.i.Integer:case s.i.Rational:case s.i.Decimal:return"a number";case s.i.Character:return"a character";case s.i.String:return"a string";case s.i.Keyword:return"a keyword";case s.i.Placeholder:return"a template";default:return"something else"}}const a=(e,t)=>`Actual value ${e} differs from ${t}, the expected value.`,o=e=>`${e} cannot compare functions.`,c=(e,t,n)=>`${e} cannot compare inexact numbers. Try (check-within ${t} ${n} range).`,u=e=>`check-error expected an error, but instead received the value ${e}`,l=e=>`check-error: expects a string (the expected error message) for the second argument. Given ${e}`,d=(e,t,n)=>`Actual value ${e} is not between ${t} and ${n}, inclusive.`,h=(e,t)=>`Actual value ${e} differs from all given members in ${t.join(" ")}`,m=(e,t)=>`Actual value ${t} does not satisfy ${e}.`,p=(e,t,n)=>`Actual value ${e} is not within ${n} of expected value ${t}`,w=(e,t)=>`check-satisfied encountered an error instead of the expected kind of value, "${e}".\n  :: ${e} [as predicate in check-satisfied]: is expected to return a boolean, but it returned ${t}`,g=e=>`${e}: found a test that is not at the top level`,f=(e,t)=>`check-error encountered the following error instead of the expected ${e}\n  :: ${t}`,y="cond: all question results were false",v="cond: found an else clause that isn't the last clause in its cond expression",x=e=>{if(!e)return"cond: expected a clause after cond, but nothing's there";if(!(0,r.MW)(e))return`cond: expected a clause with a question and an answer, but found ${i(e)}`;switch(e.subSExprs.length){case 0:return"cond: expected a clause with a question and an answer, but found an empty part";case 1:return"cond: expected a clause with a question and an answer, but found a clause with only one part";default:return`cond: expected a clause with a question and an answer, but found a clause with ${e.subSExprs.length} parts`}},T=e=>`define: found a variable that is used more than once: ${e}`,b="define: expected at least one variable after the function name, but found none",E=e=>`define: expected an expression after the variable name ${e}, but nothing's there`,k="define: expected an expression for the function body, but nothing's there",C=e=>"define: expected the name of the function, but "+(e?`found ${i(e)}`:"nothing's there"),S=e=>"define: expected a variable name, or a function name and its variables (in parentheses), but "+(e?`found ${i(e)}`:"nothing's there"),$=e=>`define: expected a variable, but found ${i(e)}`,A=(e,t)=>`define: expected only one expression after the variable name ${e}, but found ${t} extra part${t>1?"s":""}`,B=e=>`define: expected only one expression for the function body, but found ${e} extra part${e>1?"s":""}`,P=e=>`${e}: this name was defined previously and cannot be re-defined`,F=e=>`define-struct: found a field name that is used more than once: ${e}`,N=e=>`define-struct: expected a field name, but found ${i(e)}`,R=e=>"define-struct: expected at least one field name (in parentheses) after the structure name, but "+(e?`found ${i(e)}`:"nothing's there"),H=e=>"define-struct: expected the structure name after define-struct, but "+(e?`found ${i(e)}`:"nothing's there"),M=e=>`define-struct: expected nothing after the field names, but found ${e} extra part${e>1?"s":""}`,q=e=>`${e}: expected a finished expression, but found a template`,D="else: not allowed here, because this is not a question in a clause",L=(e,t,n)=>t<n?0===t?`${e}: expects no argument, but found ${n}`:`${e}: expects only ${t} argument${t>1?"s":""}, but found ${n}`:`${e}: expects ${t} argument${t>1?"s":""}, but found ${0===n?"none":`only ${n}`}`,_=e=>`${e}: complex numbers are not supported`,W="/: division by zero",I=(e,t,n)=>`${e}: expects at least ${t} argument${t>1?"s":""}, but found ${n>=2?n:1===n?"only 1":"none"}`,O=(e,t,n,r)=>`${e}: expects a${t.match(/^[aeiou]/)?"n":""} ${t} as ${function(e){const t=e%10,n=e%100;return 1==t&&11!=n?e+"st":2==t&&12!=n?e+"nd":3==t&&13!=n?e+"rd":e+"th"}(n+1)} argument, given ${r}`,Z=(e,t,n)=>`${e}: expects a${t.match(/^[aeiou]/)?"n":""} ${t}, given ${n}`,K=e=>"function call: expected a function after the open parenthesis, but "+(e?`found ${i(e)}`:"nothing's there"),U=(e,t,n)=>`${e}: contract violation\n  expected: ${t}\n  received: ${n}`,z=(e,t,n)=>`${e}: expected a boolean from ${t} (the function given to ${e}), but received ${n}`,X=e=>`${e}: expects (at least) one list argument, given none`,V=(e,t,n,r)=>`${e}: all lists must have same size\n  first list length: ${t}\n  other list length: ${n}\n  procedure: ${r}`,G=e=>0===e?"if: expected a question and two answers, but nothing's there":1===e?"if: expected a question and two answers, but found only 1 part":2===e?"if: expected a question and two answers, but found only 2 parts":`if: expected a question and two answers, but found ${e} parts`,Y=e=>`lambda: found a variable that is used more than once: ${e}`,j=e=>0===e?"lambda: expected an expression for the function body, but nothing's there":`lambda: expected only one expression for the function body, but found ${e} extra parts`,J=(e=null)=>"lambda: expected (lambda (variable more-variable ...) expression), but "+(e?`found ${i(e)}`:"nothing's there"),Q=e=>`lambda: expected a variable, but found ${i(e)}`,ee="lambda: expected (lambda (variable more-variable ...) expression), but found no variables",te="lambda: found a lambda that is not a function definition",ne=e=>`local: expected a definition, but found ${i(e)}`,re=(e=null)=>"local: expected at least one definition (in square brackets) after local, but "+(e?`found ${i(e)}`:"nothing's there"),se="local: expected an expression after the local definitions, but nothing's there",ie=e=>`local: expected only one expression after the local definitions, but found ${e} extra part${e>1?"s":""}`,ae=e=>`local: ${e} was defined locally more than once`,oe=(e,t)=>`${e}: expected an expression after the name ${t}, but nothing's there`,ce=(e,t,n)=>`${e}: expected only one expression after the name ${t}, but found ${n} extra part${n>1?"s":""}`,ue=(e,t)=>`${e}: expected a variable for the binding, but found ${i(t)}`,le=(e,t=null)=>`${e}: expected at least one binding (in parentheses) after ${e}, but ${t?`found ${i(t)}`:"nothing's there"}`,de=e=>`${e}: expected an expression after the bindings, but nothing's there`,he=(e,t)=>`${e}: expected an expression after the bindings, but found ${t} extra part${t>1?"s":""}`,me=(e,t)=>`${e}: expected a binding with a variable and an expression, but found ${i(t)}`,pe="quote: expected an expression after quote, but nothing's there",we=e=>`quote: expected only one expression after quote, but found ${e} extra part${e>1?"s":""}`,ge=e=>`quote: expected the name of a symbol or () after the quote, but found ${i(e)}`,fe=(e,t)=>0===e?"require: expected a module name after `require', but found nothing":e>1?`require: expected a single module name after \`require', but found ${e} parts`:`require: expected a module name after \`require', found ${i(t)}`,ye=e=>`require: module not found: ${e}`,ve="require: found a module require that is not at the top level",xe=e=>`read-syntax: bad character constant \`${e}\``,Te=e=>`read-syntax: bad syntax \`${e}\``,be=e=>`read-syntax: division by zero in \`${e}\``,Ee="read-syntax: end-of-file following `\\` in symbol",ke="read-syntax: expected a character after `#\\`",Ce=e=>"("===e?"read-syntax: expected a `)` to close preceding `(`":"["===e?"read-syntax: expected a `]` to close preceding `[`":"read-syntax: expected a `}` to close preceding `{`",Se="read-syntax: end of file in `#|` comment",$e="read-syntax: end-of-file following `|` in symbol",Ae='read-syntax: expected a closing `"`',Be="read-syntax: expected a commented-out element for `#;`, but found end-of-file",Pe=(e,t)=>"("===e?`read-syntax: expected \`)\` to close preceding \`(\`, found instead \`${t}\``:"["===e?`read-syntax: expected \`]\` to close preceding \`[\`, found instead \`${t}\``:`read-syntax: expected \`}\` to close preceding \`{\`, found instead \`${t}\``,Fe=e=>`read-syntax: expected an element for quoting "'", but found ${e}`,Ne=e=>`read-syntax: expected an element for unquoting "'", but found ${e}`,Re=e=>`read-syntax: illegal use of \`${e}\``,He="read-syntax: nested quotes are not supported",Me=e=>`read-syntax: unexpected \`${e}\``,qe=e=>`read-syntax: unknown escape sequence \`\\${e}\` in string`,De="runtime: maximum call stack size exceeded",Le=e=>`${e}: this function is undefined`,_e=e=>`${e}: this variable is not defined`,We=e=>`${e} is used here before its definition`,Ie=e=>`${e}: expected an open parenthesis before ${e}, but found none`,Oe=(e,t)=>`${e}: misuse of a ${t} or ${e}, not under a quasiquoting backquote`,Ze=e=>`${e}: misuse of ${e} within a quas`,Ke=e=>`${e}: expected a function call, but there is no open parenthesis before this function`,Ue=e=>`${e}: found a definition that is not at the top level`,ze=(e,t)=>`${e}: question result is not true or false: ${t}`,Xe=e=>`${e}: structure type; do you mean make-${e}`},1:(e,t,n)=>{"use strict";n.d(t,{x:()=>It});var r=n(794),s=n(359),i=n(34);class a{static fromDecimal(e){const t=10**e.toString().length;return new r.Af(BigInt(e*t),BigInt(t))}static toExact(e){return new r.pv(e.numerator,e.denominator)}static toInexact(e){return new r.Af(e.numerator,e.denominator)}static make(e,t,n=1n){return e?new r.pv(t,n):new r.Af(t,n)}static ceil(e){return 1n===e.denominator?e:e.isNegative()?a.make((0,r.cU)(e),e.numerator/e.denominator):a.make((0,r.cU)(e),e.numerator/e.denominator+1n)}static floor(e){return 1n===e.denominator?e:e.isNegative()?a.make((0,r.cU)(e),e.numerator/e.denominator-1n):a.make((0,r.cU)(e),e.numerator/e.denominator)}static add(e,t){const n=(0,r.cU)(e)&&(0,r.cU)(t),s=e.numerator*t.denominator+e.denominator*t.numerator,i=e.denominator*t.denominator;return a.make(n,s,i)}static div(e,t){const n=(0,r.cU)(e)&&(0,r.cU)(t),s=e.numerator*t.denominator,i=e.denominator*t.numerator;return a.make(n,s,i)}static mul(e,t){const n=(0,r.cU)(e)&&(0,r.cU)(t),s=e.numerator*t.numerator,i=e.denominator*t.denominator;return a.make(n,s,i)}static sub(e,t){const n=(0,r.cU)(e)&&(0,r.cU)(t),s=e.numerator*t.denominator-e.denominator*t.numerator,i=e.denominator*t.denominator;return a.make(n,s,i)}static pow(e,t){if(t.isZero())return new r.pv(1n);if(e.isZero())return new r.pv(0n);if(e.isNegative()&&1n!==t.denominator)throw"illegal state: complex numbers not supported";{let n,s,i;if(t.isNegative()?(n=t.negate(),s=e.denominator**n.numerator,i=e.numerator**n.numerator):(n=t,s=e.numerator**n.numerator,i=e.denominator**n.numerator),a.perfectPower(s,t.denominator)&&a.perfectPower(i,t.denominator)){const n=(0,r.cU)(e)&&(0,r.cU)(t);return a.make(n,a.iroot(s,t.denominator),a.iroot(i,t.denominator))}return a.fromDecimal(Number(s)**(1/Number(n.denominator))/Number(i)**(1/Number(n.denominator)))}}static perfectPower(e,t){return a.iroot(e,t)**t===e}static iroot(e,t){let n=e+1n;const r=t-1n;let s=e;for(;s<n;)n=s,s=(s*r+e/s**r)/t;return n}}var o=n(819),c=n(432);const u=new r.Af(6121026514868073n,2251799813685248n),l=new r.Af(884279719003555n,281474976710656n);class d extends r.em{constructor(){super("*",{minArity:2,relaxedMinArity:0})}getType(e){return new s.B5(new Array(e).fill(new s.sw),new s.sw)}call(e){return e.reduce(((e,t)=>a.mul(e,t)),new r.pv(1n))}}class h extends r.em{constructor(){super("+",{minArity:2,relaxedMinArity:0})}getType(e){return new s.B5(new Array(e).fill(new s.sw),new s.sw)}call(e){return e.reduce(((e,t)=>a.add(e,t)),new r.pv(0n))}}class m extends r.em{constructor(){super("-",{minArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.sw),new s.sw)}call(e){return 1===e.length?e[0].negate():e.slice(1).reduce(((e,t)=>a.sub(e,t)),e[0])}}class p extends r.em{constructor(){super("/",{minArity:2,relaxedMinArity:0})}getType(e){return new s.B5(new Array(e).fill(new s.sw),new s.sw)}call(e,t){if(1===e.length){if(e[0].isZero())throw new c.ME(i.n4,t);return a.div(a.make(!0,1n),e[0])}return e.slice(1).reduce(((e,n)=>{if(n.isZero())throw new c.ME(i.n4,t);return a.div(e,n)}),e[0])}}class w extends r.em{constructor(){super("<",{minArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.hZ),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(!(e[t].toDecimal()<e[t+1].toDecimal()))return r.Tg;return r.Xp}}class g extends r.em{constructor(){super("<=",{minArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.hZ),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(!(e[t].toDecimal()<=e[t+1].toDecimal()))return r.Tg;return r.Xp}}class f extends r.em{constructor(){super("=",{minArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.sw),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(e[t].toDecimal()!==e[t+1].toDecimal())return r.Tg;return r.Xp}}class y extends r.em{constructor(){super(">",{minArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.hZ),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(!(e[t].toDecimal()>e[t+1].toDecimal()))return r.Tg;return r.Xp}}class v extends r.em{constructor(){super(">=",{minArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.hZ),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(!(e[t].toDecimal()>=e[t+1].toDecimal()))return r.Tg;return r.Xp}}class x extends r.em{constructor(){super("abs")}getType(){return new s.B5([new s.hZ],new s.hZ)}call(e){const t=e[0];return t.isNegative()?t.negate():t}}class T extends r.em{constructor(){super("add1")}getType(){return new s.B5([new s.sw],new s.sw)}call(e){return a.add(e[0],new r.pv(1n))}}class b extends r.em{constructor(){super("ceiling")}getType(){return new s.B5([new s.hZ],new s.Fc)}call(e){return a.ceil(e[0])}}class E extends r.em{constructor(){super("current-seconds")}getType(){return new s.B5([],new s.D9)}call(e){return a.make(!0,BigInt(Math.floor((new Date).getTime()/1e3)))}}class k extends r.em{constructor(){super("denominator")}getType(){return new s.B5([new s.Ee],new s.Fc)}call(e){const t=e[0];return a.make((0,r.cU)(t),t.denominator)}}class C extends r.em{constructor(){super("even?")}getType(){return new s.B5([new s.Fc],new s.wy)}call(e){return(0,r.K_)(e[0].numerator%2n===0n)}}class S extends r.em{constructor(){super("exact->inexact")}getType(){return new s.B5([new s.sw],new s.sw)}call(e){return a.toInexact(e[0])}}class $ extends r.em{constructor(){super("exp")}getType(){return new s.B5([new s.sw],new s.sw)}call(e){return a.pow(u,e[0])}}class A extends r.em{constructor(){super("expt")}getType(){return new s.B5([new s.sw,new s.sw],new s.sw)}call(e,t){const n=e[0],r=e[1];if(n.isNegative()&&1n!==r.denominator)throw new c.ME((0,i.vL)(this.name),t);return a.pow(n,r)}}class B extends r.em{constructor(){super("floor")}getType(){return new s.B5([new s.hZ],new s.Fc)}call(e){return a.floor(e[0])}}class P extends r.em{constructor(){super("inexact->exact")}getType(){return new s.B5([new s.sw],new s.sw)}call(e){return a.toExact(e[0])}}class F extends r.em{constructor(){super("inexact?")}getType(){return new s.B5([new s.sw],new s.wy)}call(e){return(0,r.K_)((0,r.gX)(e[0]))}}class N extends r.em{constructor(){super("integer?")}getType(){return new s.B5([new s.Hs],new s.wy)}call(e){return(0,r.K_)((0,r.Oz)(e[0]))}}class R extends r.em{constructor(){super("max",{minArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.hZ),new s.hZ)}call(e){return e.slice(1).reduce(((e,t)=>e.toDecimal()>t.toDecimal()?e:t),e[0])}}class H extends r.em{constructor(){super("min",{minArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.hZ),new s.hZ)}call(e){return e.slice(1).reduce(((e,t)=>e.toDecimal()<t.toDecimal()?e:t),e[0])}}class M extends r.em{constructor(){super("modulo")}getType(){return new s.B5([new s.Fc,new s.Fc],new s.Fc)}call(e){const t=e[0].numerator,n=e[1].numerator,s=(0,r.cU)(e[0])&&(0,r.cU)(e[1]);return t>0&&n<0?a.make(s,t%n+n):a.make(s,t%n)}}class q extends r.em{constructor(){super("negative?")}getType(){return new s.B5([new s.hZ],new s.wy)}call(e){return(0,r.K_)(e[0].isNegative())}}class D extends r.em{constructor(){super("number->string")}getType(){return new s.B5([new s.sw],new s.uW)}call(e){return new r.tm(a.toExact(e[0]).stringify())}}class L extends r.em{constructor(e){super(e||"number?")}getType(){return new s.B5([new s.Hs],new s.wy)}call(e){return(0,r.K_)((0,r.LF)(e[0]))}}class _ extends r.em{constructor(){super("numerator")}getType(){return new s.B5([new s.Ee],new s.Fc)}call(e){const t=e[0];return a.make((0,r.cU)(t),t.numerator)}}class W extends r.em{constructor(){super("odd?")}getType(){return new s.B5([new s.Fc],new s.wy)}call(e){return(0,r.K_)(e[0].numerator%2n===1n)}}class I extends r.em{constructor(){super("positive?")}getType(){return new s.B5([new s.hZ],new s.wy)}call(e){return(0,r.K_)(e[0].isPositive())}}class O extends r.em{constructor(){super("quotient")}getType(){return new s.B5([new s.Fc,new s.Fc],new s.Fc)}call(e){const t=e[0],n=e[1],s=(0,r.cU)(t)&&(0,r.cU)(n);return a.make(s,t.numerator/n.numerator)}}class Z extends r.em{constructor(){super("random")}getType(){return new s.B5([new s.NL],new s.D9)}call(e){return new r.pv(BigInt(Math.floor(o.i.next()*Number(e[0].numerator))))}}class K extends r.em{constructor(){super("remainder")}getType(){return new s.B5([new s.Fc,new s.Fc],new s.Fc)}call(e){const t=e[0],n=e[1],s=(0,r.cU)(t)&&(0,r.cU)(n);return a.make(s,t.numerator-n.numerator*(t.numerator/n.numerator))}}class U extends r.em{constructor(){super("round")}getType(){return new s.B5([new s.hZ],new s.Fc)}call(e){const t=e[0],n=(0,r.cU)(t);return 2n===t.denominator?t.numerator/2n%2n===0n?a.make(n,t.numerator/t.denominator):a.make(n,t.numerator/t.denominator+1n):t.numerator-t.denominator*(t.numerator/t.denominator)<t.denominator?a.make(n,t.numerator/t.denominator):a.make(n,t.numerator/t.denominator+1n)}}class z extends r.em{constructor(){super("sqr"),this.expt=new r.pv(2n)}getType(){return new s.B5([new s.sw],new s.sw)}call(e){return a.pow(e[0],this.expt)}}class X extends r.em{constructor(){super("sgn")}getType(){return new s.B5([new s.hZ],new s.hE([],[new r.pv(1n),new r.Af(1n),new r.pv(0n),new r.Af(0n),new r.pv(-1n),new r.Af(-1n)]))}call(e){const t=e[0],n=(0,r.cU)(t);return t.isPositive()?a.make(n,1n):t.isNegative()?a.make(n,-1n):a.make(n,0n)}}class V extends r.em{constructor(){super("sqrt"),this.expt=new r.pv(1n,2n)}getType(){return new s.B5([new s.sw],new s.sw)}call(e,t){const n=e[0];if(n.isNegative())throw new c.ME((0,i.vL)(this.name),t);return a.pow(n,this.expt)}}class G extends r.em{constructor(){super("sub1")}getType(){return new s.B5([new s.sw],new s.sw)}call(e){return a.sub(e[0],new r.pv(1n))}}class Y extends r.em{constructor(){super("zero?")}getType(){return new s.B5([new s.sw],new s.wy)}call(e){return(0,r.K_)(e[0].isZero())}}var j=n(246),J=n(789),Q=n(96);class ee extends r.em{assertBooleanType(e,t,n){if(!(0,r.JI)(e))throw new c.ME((0,i.Lx)(super.name,t.stringify(),e.stringify()),n)}assertCorrectType(e,t,n){if((0,s.xW)(e)){if(e.isCompatibleWith(t))return}else if(!(0,r.up)(t)&&e.isSuperTypeOf(t.getType(-1),t))return;throw new c.ME((0,i.HQ)(this.name,e.stringify(),t.stringify()),n)}assertListsLength(e,t,n){const r=e[0].vals.length;for(const s of e.slice(1))if(s.vals.length!==r)throw new c.ME((0,i.Qe)(this.name,r,s.vals.length,t.stringify()),n)}}class te extends ee{constructor(){super("andmap",{minArityWithoutLists:1})}getType(e){return new s.B5([new s.B5(new Array(e-1).fill(new s.Hs),new s.wy),...new Array(e-1).fill(new s.RH)],new s.RH)}call(e,t,n){const s=e[0],i=e.slice(1);this.assertListsLength(i,s,t);for(let e=0;e<i[0].vals.length;e++){const a=s.accept(new Q.u(i.map((n=>new J.RD(n.vals[e],t))),n,t));if(this.assertBooleanType(a,s,t),(0,r.h8)(a))return r.Tg}return r.Xp}}class ne extends ee{constructor(){super("apply",{minArity:2})}getType(e){return new s.B5([new s.wj].concat(new Array(e-2).fill(new s.Hs).concat(new s.RH)),new s.Hs)}call(e,t,n){const r=e[0],s=e.slice(1,-1).concat(...e[e.length-1].vals);return r.accept(new Q.u(s.map((e=>new J.RD(e,t))),n,t))}}class re extends ee{constructor(){super("argmax")}getType(){return new s.B5([new s.B5([new s.Hs],new s.hZ),new s.RH(1)],new s.Hs)}call(e,t,n){const r=e[0],i=e[1];let a=i.vals[0],o=r.accept(new Q.u([new J.RD(a,t)],n,t));this.assertCorrectType(new s.hZ,o,t);for(const e of i.vals.slice(1)){const i=r.accept(new Q.u([new J.RD(e,t)],n,t));this.assertCorrectType(new s.hZ,i,t),i.toDecimal()>o.toDecimal()&&(a=e,o=i)}return a}}class se extends ee{constructor(){super("argmin")}getType(){return new s.B5([new s.B5([new s.Hs],new s.hZ),new s.RH(1)],new s.Hs)}call(e,t,n){const r=e[0],i=e[1];let a=i.vals[0],o=r.accept(new Q.u([new J.RD(a,t)],n,t));this.assertCorrectType(new s.hZ,o,t);for(const e of i.vals.slice(1)){const i=r.accept(new Q.u([new J.RD(e,t)],n,t));this.assertCorrectType(new s.hZ,i,t),i.toDecimal()>o.toDecimal()&&(a=e,o=i)}return a}}class ie extends ee{constructor(){super("build-list")}getType(){return new s.B5([new s.D9,new s.B5([new s.D9],new s.Hs)],new s.RH)}call(e,t,n){const s=e[1],i=[];for(let r=0n;r<e[0].numerator;r++){const e=new Q.u([new J.RD(a.make(!0,r),t)],n,t);i.push(s.accept(e))}return new r.zG(i)}}class ae extends ee{constructor(){super("compose")}getType(e){return new s.B5(new Array(Math.max(1,e)).fill(new s.wj),new s.wj)}call(e,t,n){return 1===e.length?e[0]:new r.BC(...e.reverse())}}class oe extends ee{constructor(){super("filter")}getType(){return new s.B5([new s.B5([new s.Hs],new s.wy),new s.RH],new s.RH)}call(e,t,n){const s=e[0],i=e[1],a=[];for(const e of i.vals){const i=s.accept(new Q.u([new J.RD(e,t)],n,t));this.assertBooleanType(i,s,t),(0,r.Zb)(i)&&a.push(e)}return new r.zG(a)}}class ce extends ee{constructor(){super("foldl",{minArityWithoutLists:2})}getType(e){return new s.B5([new s.B5(new Array(e-1).fill(new s.Hs),new s.Hs),new s.Hs,...new Array(e-2).fill(new s.RH)],new s.Hs)}call(e,t,n){const r=e[0],s=e[1],i=e.slice(2);this.assertListsLength(i,r,t);let a=s;for(let e=0;e<i[0].vals.length;e++)a=r.accept(new Q.u(i.map((n=>new J.RD(n.vals[e],t))).concat([new J.RD(a,t)]),n,t));return a}}class ue extends ee{constructor(){super("foldr",{minArityWithoutLists:2})}getType(e){return new s.B5([new s.B5(new Array(e-1).fill(new s.Hs),new s.Hs),new s.Hs,...new Array(e-2).fill(new s.RH)],new s.Hs)}call(e,t,n){const r=e[0],s=e[1],i=e.slice(2);this.assertListsLength(i,r,t);let a=s;for(let e=i[0].vals.length-1;e>=0;e--)a=r.accept(new Q.u(i.map((n=>new J.RD(n.vals[e],t))).concat([new J.RD(a,t)]),n,t));return a}}class le extends ee{constructor(){super("map",{minArityWithoutLists:1})}getType(e){return new s.B5([new s.B5(new Array(e-1).fill(new s.Hs),new s.Hs),...new Array(e-1).fill(new s.RH)],new s.RH)}call(e,t,n){const s=e[0],i=e.slice(1);this.assertListsLength(i,s,t);const a=[];for(let e=0;e<i[0].vals.length;e++)a.push(s.accept(new Q.u(i.map((n=>new J.RD(n.vals[e],t))),n,t)));return new r.zG(a)}}class de extends ee{constructor(){super("memf")}getType(){return new s.B5([new s.B5([new s.Hs],new s.Hs),new s.RH],new s.hE([new s.RH],[new r.es(!1)]))}call(e,t,n){const s=e[0],i=e[1];for(const[e,a]of i.vals.entries()){const o=s.accept(new Q.u([new J.RD(a,t)],n,t));if(!(0,r.h8)(o))return new r.zG(i.vals.slice(e))}return r.Tg}}class he extends ee{constructor(){super("ormap",{minArityWithoutLists:1})}getType(e){return new s.B5([new s.B5(new Array(e-1).fill(new s.Hs),new s.wy),...new Array(e-1).fill(new s.RH)],new s.RH)}call(e,t,n){const s=e[0],i=e.slice(1);this.assertListsLength(i,s,t);for(let e=0;e<i[0].vals.length;e++){const a=s.accept(new Q.u(i.map((n=>new J.RD(n.vals[e],t))),n,t));if(this.assertBooleanType(a,s,t),(0,r.Zb)(a))return r.Xp}return r.Tg}}class me extends r.em{constructor(){super("procedure?")}getType(){return new s.B5([new s.Hs],new s.wy)}call(e){return(0,r.K_)((0,r.up)(e[0]))}}class pe extends ee{constructor(){super("sort")}getType(){return new s.B5([new s.RH,new s.B5([new s.Hs,new s.Hs],new s.wy)],new s.RH)}call(e,t,n){const s=e[0],i=e[1];return new r.zG(s.vals.sort(((e,s)=>{const a=i.accept(new Q.u([new J.RD(e,t),new J.RD(s,t)],n,t));return this.assertBooleanType(a,i,t),(0,r.Zb)(a)?-1:1})))}}const we=r.K8;class ge extends r.em{constructor(){super("append",{minArity:2})}getType(e){return new s.B5(new Array(e).fill(new s.RH),new s.RH)}call(e){return new r.zG(e.flatMap((e=>e.vals)))}}class fe extends r.em{constructor(){super("car")}getType(){return new s.B5([new s.FJ],new s.Hs)}call(e){return e[0].vals[0]}}class ye extends r.em{constructor(){super("cdr")}getType(){return new s.B5([new s.FJ],new s.Hs)}call(e){return new r.zG(e[0].vals.slice(1))}}class ve extends r.em{constructor(){super("cons")}getType(){return new s.B5([new s.Hs,new s.RH],new s.RH)}call(e){return new r.zG([e[0],...e[1].vals])}}class xe extends r.em{constructor(){super("eighth")}getType(){return new s.B5([new s.RH(8)],new s.Hs)}call(e){return e[0].vals[7]}}class Te extends r.em{constructor(e){super(e||"empty?")}getType(){return new s.B5([new s.Hs],new s.wy)}call(e){return(0,r.K_)((0,r.bm)(e[0]))}}class be extends r.em{constructor(){super("fifth")}getType(){return new s.B5([new s.RH(5)],new s.Hs)}call(e){return e[0].vals[4]}}class Ee extends r.em{constructor(){super("first")}getType(){return new s.B5([new s.RH(1)],new s.Hs)}call(e){return e[0].vals[0]}}class ke extends r.em{constructor(){super("fourth")}getType(){return new s.B5([new s.RH(4)],new s.Hs)}call(e){return e[0].vals[3]}}class Ce extends r.em{constructor(){super("length")}getType(){return new s.B5([new s.RH],new s.D9)}call(e){return a.make(!0,BigInt(e[0].vals.length))}}class Se extends r.em{constructor(){super("list",{})}getType(e){return new s.B5(new Array(e).fill(new s.Hs),new s.RH(e))}call(e){return new r.zG(e)}}class $e extends r.em{constructor(){super("list*",{minArity:1})}getType(e){return new s.B5(new Array(e-1).fill(new s.Hs).concat([new s.RH]),new s.RH(e-1))}call(e){return new r.zG(e.slice(0,-1).concat(e[e.length-1].vals))}}class Ae extends r.em{constructor(e){super(e||"list?")}getType(){return new s.B5([new s.Hs],new s.wy)}call(e){return(0,r.K_)((0,r.Dw)(e[0]))}}class Be extends r.em{constructor(){super("make-list")}getType(){return new s.B5([new s.D9,new s.Hs],new s.RH)}call(e){return new r.zG(new Array(Number(e[0].numerator)).fill(e[1]))}}class Pe extends r.em{constructor(e){super(e||"member")}getType(){return new s.B5([new s.Hs,new s.RH],new s.wy)}call(e){const t=e[0];return(0,r.K_)((0,r.oh)(t)&&e[1].vals.some((e=>t.equal(e))))}}class Fe extends r.em{constructor(){super("remove")}getType(){return new s.B5([new s.Hs,new s.RH],new s.RH)}call(e){const t=e[0],n=e[1].vals;if((0,r.oh)(t)){for(const[e,s]of n.entries())if(t.equal(s))return new r.zG(n.slice(0,e).concat(n.slice(e+1)));return e[1]}return e[1]}}class Ne extends r.em{constructor(){super("remove-all")}getType(){return new s.B5([new s.Hs,new s.RH],new s.RH)}call(e){const t=e[0];return(0,r.oh)(t)?new r.zG(e[1].vals.filter((e=>!t.equal(e)))):e[1]}}class Re extends r.em{constructor(){super("rest")}getType(){return new s.B5([new s.RH(1)],new s.RH)}call(e){return new r.zG(e[0].vals.slice(1))}}class He extends r.em{constructor(){super("reverse")}getType(){return new s.B5([new s.RH],new s.RH)}call(e){return new r.zG(e[0].vals.reverse())}}class Me extends r.em{constructor(){super("second")}getType(){return new s.B5([new s.RH(2)],new s.Hs)}call(e){return e[0].vals[1]}}class qe extends r.em{constructor(){super("seventh")}getType(){return new s.B5([new s.RH(7)],new s.Hs)}call(e){return e[0].vals[6]}}class De extends r.em{constructor(){super("sixth")}getType(){return new s.B5([new s.RH(6)],new s.Hs)}call(e){return e[0].vals[5]}}class Le extends r.em{constructor(){super("third")}getType(){return new s.B5([new s.RH(3)],new s.Hs)}call(e){return e[0].vals[2]}}class _e extends r.em{constructor(){super("boolean->string")}getType(){return new s.B5([new s.wy],new s.uW)}call(e){return e[0].val?new r.tm("#true"):new r.tm("#false")}}class We extends r.em{constructor(){super("boolean=?")}getType(){return new s.B5([new s.wy,new s.wy],new s.wy)}call(e){return(0,r.K_)(e[0]===e[1])}}class Ie extends r.em{constructor(){super("boolean?")}getType(){return new s.B5([new s.Hs],new s.wy)}call(e){return(0,r.K_)((0,r.JI)(e[0]))}}class Oe extends r.em{constructor(){super("false?")}getType(){return new s.B5([new s.Hs],new s.wy)}call(e){return(0,r.K_)(!1===e[0].val)}}class Ze extends r.em{constructor(){super("not")}getType(){return new s.B5([new s.wy],new s.wy)}call(e){return(0,r.K_)(!e[0].val)}}class Ke extends r.em{constructor(){super("symbol->string")}getType(){return new s.B5([new s.Ko],new s.uW)}call(e){return new r.tm(e[0].val)}}class Ue extends r.em{constructor(){super("symbol=?")}getType(){return new s.B5([new s.Ko,new s.Ko],new s.wy)}call(e){return(0,r.K_)(e[0].val===e[1].val)}}class ze extends r.em{constructor(){super("symbol?")}getType(){return new s.B5([new s.Hs],new s.wy)}call(e){return(0,r.K_)((0,r.re)(e[0]))}}class Xe extends r.em{constructor(){super("char->integer")}getType(){return new s.B5([new s.sr],new s.D9)}call(e){return a.make(!0,BigInt(e[0].val.charCodeAt(0)))}}class Ve extends r.em{constructor(){super("char-alphabetic?")}getType(){return new s.B5([new s.sr],new s.wy)}call(e){return(0,r.K_)(!!e[0].val.match(/^[a-z]$/i))}}class Ge extends r.em{constructor(){super("explode")}getType(){return new s.B5([new s.uW],new s.RH)}call(e){return new r.zG(e[0].val.split("").map((e=>new r.tm(e))))}}class Ye extends r.em{constructor(){super("make-string")}getType(){return new s.B5([new s.D9,new s.sr],new s.uW)}call(e){return new r.tm(e[1].val.repeat(Number(e[0].numerator)))}}class je extends r.em{constructor(){super("replicate")}getType(){return new s.B5([new s.D9,new s.uW],new s.uW)}call(e){return new r.tm(e[1].val.repeat(Number(e[0].numerator)))}}class Je extends r.em{constructor(){super("string")}getType(e){return new s.B5(new Array(e).fill(new s.sr),new s.uW)}call(e){return new r.tm(e.map((e=>e.val)).join(""))}}class Qe extends r.em{constructor(){super("string->symbol")}getType(){return new s.B5([new s.uW],new s.Ko)}call(e){return new r.iN(e[0].val)}}class et extends r.em{constructor(){super("string-alphabetic?")}getType(){return new s.B5([new s.uW],new s.wy)}call(e){return(0,r.K_)(!!e[0].val.match(/^[a-z]*$/i))}}class tt extends r.em{constructor(){super("string-append",{minArity:2,relaxedMinArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.uW),new s.uW)}call(e){return new r.tm(e.map((e=>e.val)).join(""))}}class nt extends r.em{constructor(){super("string-ci<=?",{minArity:2,relaxedMinArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.uW),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(!(e[t].val.toLowerCase()<=e[t+1].val.toLowerCase()))return r.Tg;return r.Xp}}class rt extends r.em{constructor(){super("string-ci<?",{minArity:2,relaxedMinArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.uW),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(!(e[t].val.toLowerCase()<e[t+1].val.toLowerCase()))return r.Tg;return r.Xp}}class st extends r.em{constructor(){super("string-ci=?",{minArity:2,relaxedMinArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.uW),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(e[t].val.toLowerCase()!==e[t+1].val.toLowerCase())return r.Tg;return r.Xp}}class it extends r.em{constructor(){super("string-ci>=?",{minArity:2,relaxedMinArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.uW),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(!(e[t].val.toLowerCase()>=e[t+1].val.toLowerCase()))return r.Tg;return r.Xp}}class at extends r.em{constructor(){super("string-ci>?",{minArity:2,relaxedMinArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.uW),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(!(e[t].val.toLowerCase()>=e[t+1].val.toLowerCase()))return r.Tg;return r.Xp}}class ot extends r.em{constructor(){super("string-contains-ci?")}getType(){return new s.B5([new s.uW,new s.uW],new s.wy)}call(e){return(0,r.K_)(e[1].val.toLowerCase().includes(e[0].val.toLowerCase()))}}class ct extends r.em{constructor(){super("string-contains?")}getType(){return new s.B5([new s.uW,new s.uW],new s.wy)}call(e){return(0,r.K_)(e[1].val.includes(e[0].val))}}class ut extends r.em{constructor(){super("string-copy")}getType(){return new s.B5([new s.uW],new s.uW)}call(e){return new r.tm(e[0].val)}}class lt extends r.em{constructor(){super("string-downcase")}getType(){return new s.B5([new s.uW],new s.uW)}call(e){return new r.tm(e[0].val.toLowerCase())}}class dt extends r.em{constructor(){super("string-length")}getType(){return new s.B5([new s.uW],new s.D9)}call(e){return new r.pv(BigInt(e[0].val.length))}}class ht extends r.em{constructor(){super("string-lower-case?")}getType(){return new s.B5([new s.uW],new s.wy)}call(e){return(0,r.K_)(!!e[0].val.match(/^[a-z]*$/))}}class mt extends r.em{constructor(){super("string-numeric?")}getType(){return new s.B5([new s.uW],new s.wy)}call(e){return(0,r.K_)(!!e[0].val.match(/^[0-9]*$/))}}class pt extends r.em{constructor(){super("string-upcase")}getType(){return new s.B5([new s.uW],new s.uW)}call(e){return new r.tm(e[0].val.toUpperCase())}}class wt extends r.em{constructor(){super("string-upper-case?")}getType(){return new s.B5([new s.uW],new s.wy)}call(e){return(0,r.K_)(!!e[0].val.match(/^[A-Z]*$/))}}class gt extends r.em{constructor(){super("string<=?",{minArity:2,relaxedMinArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.uW),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(!(e[t].val<=e[t+1].val))return r.Tg;return r.Xp}}class ft extends r.em{constructor(){super("string<?",{minArity:2,relaxedMinArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.uW),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(!(e[t].val<e[t+1].val))return r.Tg;return r.Xp}}class yt extends r.em{constructor(){super("string=?",{minArity:2,relaxedMinArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.uW),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(e[t].val!==e[t+1].val)return r.Tg;return r.Xp}}class vt extends r.em{constructor(){super("string>=?",{minArity:2,relaxedMinArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.uW),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(!(e[t].val>=e[t+1].val))return r.Tg;return r.Xp}}class xt extends r.em{constructor(){super("string>?",{minArity:2,relaxedMinArity:1})}getType(e){return new s.B5(new Array(e).fill(new s.uW),new s.wy)}call(e){for(let t=0;t<e.length-1;t++)if(!(e[t].val>=e[t+1].val))return r.Tg;return r.Xp}}class Tt extends r.em{constructor(){super("string?")}getType(){return new s.B5([new s.Hs],new s.wy)}call(e){return(0,r.K_)((0,r.$e)(e[0]))}}var bt=n(484),Et=n(223),kt=n(625),Ct=n(239),St=n(159),$t=n(830);const At=new $t.yC((0,St.oM)(0,0)[0]);class Bt extends r.em{constructor(){super("circle")}getType(){return new s.B5([new s.Y5,new Ct.XG,new Ct.Mr],new Ct.__)}call(e){const t=Number(e[0].numerator),n=e[1],r=e[2],[s,i]=(0,St.oM)(2*t,2*t);return i.fillStyle=(0,St.$w)(r,n),i.beginPath(),(0,St.Nf)(n)&&t>St.q2?(i.arc(t,t,t+St.ko,0,St.gc),i.fill(),i.fillStyle=St.Et,i.beginPath(),i.arc(t,t,t-St.ko,0,St.gc),i.fill()):(i.arc(t,t,t,0,St.gc),i.fill()),new $t.yC(s)}}class Pt extends r.em{constructor(){super("ellipse")}getType(){return new s.B5([new s.Y5,new s.Y5,new Ct.XG,new Ct.Mr],new Ct.__)}call(e){const t=Number(e[0].numerator),n=Number(e[1].numerator),r=e[2],s=e[3],[i,a]=(0,St.oM)(t,n),o=t/2,c=n/2;return a.fillStyle=(0,St.$w)(s,r),a.beginPath(),(0,St.Nf)(r)&&t>St.q2&&n>St.q2?(a.ellipse(o,c,o+St.ko,c+St.ko,0,0,St.gc),a.fill(),a.fillStyle=St.Et,a.beginPath(),a.ellipse(o,c,o-St.ko,c-St.ko,0,0,St.gc),a.fill()):(a.ellipse(o,c,o,c,0,0,St.gc),a.fill()),new $t.yC(i)}}class Ft extends r.em{constructor(){super("beside",{minArity:2})}getType(e){return new s.B5(new Array(e).fill(new Ct.__),new Ct.__)}call(e){let t=0,n=0;for(const r of e)t+=r.canvas.width,n=Math.max(n,r.canvas.height);const[r,s]=(0,St.oM)(t,n);let i=0;for(const t of e)(0,$t.re)(t)||(s.drawImage(t.canvas,i,(n-t.canvas.height)/2),i+=t.canvas.width);return new $t.yC(r)}}class Nt extends r.em{constructor(){super("above",{minArity:2})}getType(e){return new s.B5(new Array(e).fill(new Ct.__),new Ct.__)}call(e){let t=0,n=0;for(const r of e)t=Math.max(t,r.canvas.width),n+=r.canvas.height;const[r,s]=(0,St.oM)(t,n);let i=0;for(const n of e)(0,$t.re)(n)||(s.drawImage(n.canvas,(t-n.canvas.width)/2,i),i+=n.canvas.height);return new $t.yC(r)}}class Rt extends r.em{constructor(){super("image-width")}getType(){return new s.B5([new Ct.__],new s.Y5)}call(e){const t=e[0];return a.make(!0,BigInt(t.canvas.width))}}class Ht extends r.em{constructor(){super("image-height")}getType(){return new s.B5([new Ct.__],new s.Y5)}call(e){const t=e[0];return a.make(!0,BigInt(t.canvas.height))}}class Mt extends r.em{constructor(){super("square")}getType(){return new s.B5([new s.Y5,new Ct.XG,new Ct.Mr],new Ct.__)}call(e){const t=Number(e[0].numerator),n=e[1],r=e[2],[s,i]=(0,St.oM)(t,t);return i.fillStyle=(0,St.$w)(r,n),i.beginPath(),(0,St.Nf)(n)&&t>St.q2?(i.rect(-St.ko,-St.ko,t+St.ko,t+St.ko),i.fill(),i.fillStyle=St.Et,i.beginPath(),i.rect(St.ko,St.ko,t-St.q2,t-St.q2),i.fill()):(i.rect(0,0,t,t),i.fill()),new $t.yC(s)}}class qt extends r.em{constructor(){super("rectangle")}getType(){return new s.B5([new s.Y5,new s.Y5,new Ct.XG,new Ct.Mr],new Ct.__)}call(e){const t=Number(e[0].numerator),n=Number(e[1].numerator),r=e[2],s=e[3],[i,a]=(0,St.oM)(t,n);return a.fillStyle=(0,St.$w)(s,r),a.beginPath(),(0,St.Nf)(r)&&t>St.q2&&n>St.q2?(a.rect(-St.ko,-St.ko,t+St.ko,n+St.ko),a.fill(),a.fillStyle=St.Et,a.beginPath(),a.rect(St.ko,St.ko,t-St.q2,n-St.q2),a.fill()):(a.rect(0,0,t,n),a.fill()),new $t.yC(i)}}class Dt extends r.em{constructor(){super("image?")}getType(){return new s.B5([new s.Hs],new s.wy)}call(e){return(0,r.K_)((0,$t.gf)(e[0]))}}class Lt extends r.em{constructor(e=null){super(e||"make-color")}getType(e){return new s.B5(new Array(Math.max(3,Math.min(4,e))).fill(new Ct.e6),new Ct.Mr)}call(e){const t=e[0],n=e[1],s=e[2],i=e[3]||a.make(!0,255n);return new r.$z("color",[t,n,s,i])}}new r.Y2("color",3).getType=()=>new s.B5(new Array(3).fill(new Ct.e6),new Ct.Mr);const _t={name:"2htdp/image",procedures:[new Lt("color"),new Lt,new r.Vq("color"),new r.If("color","red",0),new r.If("color","green",1),new r.If("color","blue",2),new r.If("color","alpha",3),new Bt,new Pt,new Mt,new qt,new Ft,new Nt,new Rt,new Ht,new Dt],data:new Map([["empty-image",At]])},Wt={name:"2htdp/universe",procedures:[],data:new Map([])};class It{constructor(){if(this.higherOrderFunctions=new Set([new te,new ne,new re,new se,new ie,new ae,new oe,new ce,new ue,new le,new de,new he,new me,new pe]),It.instance)return It.instance;It.instance=this,this.primitiveScope=new bt.s,this.primitiveRelaxedScope=new bt.s,this.primitiveEnvironment=new Et.q,this.primitiveDataNames=new Set,this.primitiveStructNames=new Set,this.primitiveProcedures=new Map,this.primitiveTestFunctions=new Map,this.modules=new Map,this.primitiveTestFunctions.set(kt.Z.CheckError,{minArity:1,maxArity:2}),this.primitiveTestFunctions.set(kt.Z.CheckExpect,{arity:2}),this.primitiveTestFunctions.set(kt.Z.CheckMemberOf,{minArity:2}),this.primitiveTestFunctions.set(kt.Z.CheckRandom,{arity:2}),this.primitiveTestFunctions.set(kt.Z.CheckRange,{arity:3}),this.primitiveTestFunctions.set(kt.Z.CheckSatisfied,{arity:2}),this.primitiveTestFunctions.set(kt.Z.CheckWithin,{arity:3}),this.addDataToPrimEnv("empty",r.K8),this.addDataToPrimEnv("true",r.Xp),this.addDataToPrimEnv("false",r.Tg),this.addFnToPrimEnv(new d),this.addFnToPrimEnv(new h),this.addFnToPrimEnv(new m),this.addFnToPrimEnv(new p),this.addFnToPrimEnv(new w),this.addFnToPrimEnv(new g),this.addFnToPrimEnv(new f),this.addFnToPrimEnv(new y),this.addFnToPrimEnv(new v),this.addFnToPrimEnv(new x),this.addFnToPrimEnv(new T),this.addFnToPrimEnv(new b),this.addFnToPrimEnv(new E),this.addFnToPrimEnv(new k),this.addFnToPrimEnv(new C),this.addFnToPrimEnv(new S),this.addDataToPrimEnv("e",u),this.addFnToPrimEnv(new $),this.addFnToPrimEnv(new A),this.addFnToPrimEnv(new B),this.addFnToPrimEnv(new P),this.addFnToPrimEnv(new F),this.addFnToPrimEnv(new N),this.addFnToPrimEnv(new R),this.addFnToPrimEnv(new H),this.addFnToPrimEnv(new M),this.addFnToPrimEnv(new q),this.addFnToPrimEnv(new D),this.addFnToPrimEnv(new L),this.addFnToPrimEnv(new _),this.addFnToPrimEnv(new W),this.addDataToPrimEnv("pi",l),this.addFnToPrimEnv(new I),this.addFnToPrimEnv(new O),this.addFnToPrimEnv(new Z),this.addFnToPrimEnv(new K),this.addFnToPrimEnv(new L("rational?")),this.addFnToPrimEnv(new L("real?")),this.addFnToPrimEnv(new U),this.addFnToPrimEnv(new X),this.addFnToPrimEnv(new z),this.addFnToPrimEnv(new V),this.addFnToPrimEnv(new G),this.addFnToPrimEnv(new Y),this.addFnToPrimEnv(new _e),this.addFnToPrimEnv(new We),this.addFnToPrimEnv(new Ie),this.addFnToPrimEnv(new Oe),this.addFnToPrimEnv(new Ze),this.addFnToPrimEnv(new Ke),this.addFnToPrimEnv(new Ue),this.addFnToPrimEnv(new ze),this.addFnToPrimEnv(new ge),this.addFnToPrimEnv(new fe),this.addFnToPrimEnv(new ye),this.addFnToPrimEnv(new ve),this.addFnToPrimEnv(new Ae("cons?")),this.addFnToPrimEnv(new xe),this.addFnToPrimEnv(new Te),this.addFnToPrimEnv(new be),this.addFnToPrimEnv(new Ee),this.addFnToPrimEnv(new ke),this.addFnToPrimEnv(new Ce),this.addFnToPrimEnv(new Se),this.addFnToPrimEnv(new $e),this.addFnToPrimEnv(new Ae),this.addFnToPrimEnv(new Be),this.addFnToPrimEnv(new Pe),this.addFnToPrimEnv(new Pe("member?")),this.addDataToPrimEnv("null",we),this.addFnToPrimEnv(new Te("null?")),this.addFnToPrimEnv(new Fe),this.addFnToPrimEnv(new Ne),this.addFnToPrimEnv(new Re),this.addFnToPrimEnv(new He),this.addFnToPrimEnv(new Me),this.addFnToPrimEnv(new qe),this.addFnToPrimEnv(new De),this.addFnToPrimEnv(new Le),this.addStructToPrimEnv("posn",["x","y"]),this.addFnToPrimEnv(new Xe),this.addFnToPrimEnv(new Ve),this.addFnToPrimEnv(new Ge),this.addFnToPrimEnv(new Ye),this.addFnToPrimEnv(new je),this.addFnToPrimEnv(new Je),this.addFnToPrimEnv(new Qe),this.addFnToPrimEnv(new et),this.addFnToPrimEnv(new tt),this.addFnToPrimEnv(new nt),this.addFnToPrimEnv(new rt),this.addFnToPrimEnv(new st),this.addFnToPrimEnv(new it),this.addFnToPrimEnv(new at),this.addFnToPrimEnv(new ot),this.addFnToPrimEnv(new ct),this.addFnToPrimEnv(new ut),this.addFnToPrimEnv(new lt),this.addFnToPrimEnv(new dt),this.addFnToPrimEnv(new ht),this.addFnToPrimEnv(new mt),this.addFnToPrimEnv(new pt),this.addFnToPrimEnv(new wt),this.addFnToPrimEnv(new gt),this.addFnToPrimEnv(new ft),this.addFnToPrimEnv(new yt),this.addFnToPrimEnv(new vt),this.addFnToPrimEnv(new xt),this.addFnToPrimEnv(new Tt),this.addFnToPrimEnv(new j.Fk),this.addDataToPrimEnv("eof",j.yv),this.addFnToPrimEnv(new j.DA),this.addFnToPrimEnv(new j.OO),this.addFnToPrimEnv(new j._r),this.addFnToPrimEnv(new j.a_),this.addFnToPrimEnv(new j.h8),this.addFnToPrimEnv(new j.b7),this.addFnToPrimEnv(new j.KY),this.addFnToPrimEnv(new j.JM),this.defineScopes(),this.addModule(_t),this.addModule(Wt)}enableHigherOrderFunctions(){this.higherOrderFunctions.forEach((e=>this.addFnToPrimEnv(e))),this.defineScopes()}disableHigherOrderFunctions(){this.higherOrderFunctions.forEach((e=>this.deleteFnFormPrimEnv(e))),this.defineScopes()}addDataToPrimEnv(e,t){this.primitiveEnvironment.set(e,t),this.primitiveDataNames.add(e)}addFnToPrimEnv(e){this.primitiveEnvironment.set(e.name,e),this.primitiveProcedures.set(e.name,e)}deleteFnFormPrimEnv(e){this.primitiveEnvironment.delete(e.name),this.primitiveProcedures.delete(e.name)}addStructToPrimEnv(e,t){const n=new r.Bb(e),s=new r.Y2(e,t.length),i=new r.Vq(e),a=t.map(((t,n)=>new r.If(e,t,n)));this.primitiveEnvironment.set(e,n),this.primitiveEnvironment.set(`make-${e}`,s),this.primitiveEnvironment.set(`${e}?`,i),a.forEach((t=>{this.primitiveEnvironment.set(`${e}-${t.fieldName}`,t)})),this.primitiveStructNames.add(e),this.primitiveProcedures.set(`make-${e}`,s),this.primitiveProcedures.set(`${e}?`,i),a.forEach((t=>{this.primitiveProcedures.set(`${e}-${t.fieldName}`,t)}))}defineScopes(){this.primitiveDataNames.forEach((e=>this.primitiveScope.set(e,bt.x.Data))),this.primitiveProcedures.forEach(((e,t)=>{void 0!==e.config.relaxedMinArity&&this.primitiveRelaxedScope.set(t,bt.x.PrimitiveFunction),this.primitiveScope.set(t,bt.x.PrimitiveFunction)})),this.primitiveStructNames.forEach((e=>this.primitiveScope.set(e,bt.x.StructureType)))}addModule(e){this.modules.set(e.name,e)}}},789:(e,t,n)=>{"use strict";n.d(t,{Ov:()=>v,RD:()=>x,c$:()=>l,rx:()=>d,Up:()=>u,Us:()=>h,p8:()=>m,Et:()=>p,r_:()=>T,pW:()=>g,ho:()=>f,PM:()=>b,bK:()=>E,xf:()=>B,yq:()=>k,kt:()=>C,p7:()=>S,PJ:()=>$,O1:()=>A,s5:()=>P,fY:()=>F,HF:()=>N,Mf:()=>R,xX:()=>H,O0:()=>M,Gg:()=>q});var r=n(34),s=n(484),i=n(1),a=n(625),o=n(432);class c{constructor(e){this.sourceSpan=e,this.used=!1,this.label=""}isTemplate(){return!1}use(){this.used=!0}}class u extends c{constructor(e,t,n){super(n),this.name=e,this.args=t,this.sourceSpan=n}accept(e){return e.visitCheckNode(this)}}class l extends u{constructor(e,t){super(a.Z.CheckError,e,t),this.args=e,this.sourceSpan=t}accept(e){return D(e)?e.visitCheckErrorNode(this):e.visitCheckNode(this)}}class d extends u{constructor(e,t,n,r){super(a.Z.CheckMemberOf,[t,...n],r),this.arg=e,this.testValNode=t,this.testAgainstValNodes=n,this.sourceSpan=r}accept(e){return D(e)?e.visitCheckMemberOfNode(this):e.visitCheckNode(this)}}class h extends u{constructor(e,t,n,r,s){super(a.Z.CheckRange,[t,n,r],s),this.arg=e,this.testValNode=t,this.lowerBoundValNode=n,this.upperBoundValNode=r,this.sourceSpan=s}accept(e){return D(e)?e.visitCheckRangeNode(this):e.visitCheckNode(this)}}class m extends u{constructor(e,t,n,r,s){super(a.Z.CheckSatisfied,[t,n],s),this.arg=e,this.testValNode=t,this.testFnNode=n,this.testFnName=r,this.sourceSpan=s}accept(e){return D(e)?e.visitCheckSatisfiedNode(this):e.visitCheckNode(this)}}class p extends u{constructor(e,t,n,r,s){super(a.Z.CheckWithin,[t,n,r],s),this.arg=e,this.actualNode=t,this.expectedNode=n,this.withinNode=r,this.sourceSpan=s}accept(e){return D(e)?e.visitCheckWithinNode(this):e.visitCheckNode(this)}}class w extends c{constructor(e,t,n){super(n),this.name=e,this.nameSourceSpan=t,this.sourceSpan=n}addToScope(e,t=!1){if(e.has(this.name))throw new o.ME((0,r.B)(this.name),this.nameSourceSpan)}}class g extends w{constructor(e,t,n,r){super(e,t,r),this.name=e,this.nameSourceSpan=t,this.fields=n,this.sourceSpan=r}accept(e){return e.visitDefnStructNode(this)}addToScope(e,t=!1){if(!t){if(super.addToScope(e),e.has(`make-${this.name}`))throw new o.ME((0,r.B)(`make-${this.name}`),this.sourceSpan);if(e.has(`${this.name}?`))throw new o.ME((0,r.B)(`${this.name}?`),this.sourceSpan);this.fields.forEach((t=>{if(e.has(`${this.name}-${t}`))throw new o.ME((0,r.B)(`${this.name}-${t}`),this.sourceSpan)}))}e.set(this.name,s.x.StructureType),e.set(`make-${this.name}`,s.x.UserDefinedFunction),e.set(`${this.name}?`,s.x.UserDefinedFunction),this.fields.forEach((t=>{e.set(`${this.name}-${t}`,s.x.UserDefinedFunction)}))}}class f extends w{constructor(e,t,n,r){super(e,t,r),this.name=e,this.nameSourceSpan=t,this.value=n,this.sourceSpan=r}accept(e){return e.visitDefnVarNode(this)}isTemplate(){return this.value.isTemplate()}addToScope(e,t=!1){t||super.addToScope(e),this.value instanceof C?e.set(this.name,s.x.UserDefinedFunction):e.set(this.name,s.x.Data)}}class y extends c{}class v extends y{constructor(e,t){super(t),this.args=e,this.sourceSpan=t}accept(e){return e.visitAndNode(this)}isTemplate(){return this.args.some((e=>e.isTemplate()))}}class x extends y{constructor(e,t){super(t),this.rval=e,this.sourceSpan=t}accept(e){return e.visitAtomNode(this)}}class T extends y{constructor(e,t){super(t),this.questionAnswerClauses=e,this.sourceSpan=t}accept(e){return e.visitCondNode(this)}isTemplate(){return this.questionAnswerClauses.some((e=>e[0].isTemplate()||e[1].isTemplate()))}}class b extends y{constructor(e,t){super(t),this.placeholder=e,this.sourceSpan=t}accept(e){return e.visitEllipsisProcAppNode(this)}isTemplate(){return!0}}class E extends y{constructor(e,t){super(t),this.placeholder=e,this.sourceSpan=t}accept(e){return e.visitEllipsisNode(this)}isTemplate(){return!0}}class k extends y{constructor(e,t,n,r){super(r),this.question=e,this.trueAnswer=t,this.falseAnswer=n,this.sourceSpan=r}accept(e){return e.visitIfNode(this)}isTemplate(){return this.question.isTemplate()||this.trueAnswer.isTemplate()||this.falseAnswer.isTemplate()}}class C extends y{constructor(e,t,n,r){super(r),this.params=t,this.body=n,this.sourceSpan=r,this.name=e}accept(e){return e.visitLambdaNode(this)}isTemplate(){return this.body.isTemplate()}}class S extends y{constructor(e,t,n,r){super(r),this.name=e,this.bindings=t,this.body=n,this.sourceSpan=r}accept(e){return e.visitLetNode(this)}}class $ extends y{constructor(e,t,n){super(n),this.defns=e,this.body=t,this.sourceSpan=n}accept(e){return e.visitLocalNode(this)}isTemplate(){return this.defns.some((e=>e.isTemplate()))||this.body.isTemplate()}}class A extends y{constructor(e,t){super(t),this.args=e,this.sourceSpan=t}accept(e){return e.visitOrNode(this)}isTemplate(){return this.args.some((e=>e.isTemplate()))}}class B extends y{constructor(e,t,n){super(n),this.fn=e,this.args=t,this.sourceSpan=n}accept(e){return e.visitProcAppNode(this)}isTemplate(){return this.args.some((e=>e.isTemplate()))}}class P extends y{constructor(e,t,n){super(n),this.name=e,this.nameSourceSpan=t,this.sourceSpan=n,this.global=new i.x}accept(e){return e.visitRequireNode(this)}addToScope(e){const t=this.global.modules.get(this.name);if(!t)throw new o.ME((0,r.R6)(this.name),this.nameSourceSpan);for(const n of t.procedures)e.has(n.getName())||e.set(n.getName(),s.x.PrimitiveFunction);for(const n of t.data.keys())e.has(n)||e.set(n,s.x.Data)}}class F extends y{constructor(e,t){super(t),this.name=e,this.sourceSpan=t}accept(e){return e.visitVarNode(this)}}function N(e){return e instanceof u}function R(e){return e instanceof w}function H(e){return e instanceof C}function M(e){return e instanceof P}function q(e){return e instanceof F}function D(e){return"visitCheckErrorNode"in e}},326:(e,t,n)=>{"use strict";function r(e,t){return{token:e,sourceSpan:t}}function s(e,t){return{subSExprs:e,sourceSpan:t}}function i(e){return"token"in e}function a(e){return"subSExprs"in e}n.d(t,{Xy:()=>r,Rp:()=>s,F:()=>i,MW:()=>a})},813:(e,t,n)=>{"use strict";var r;n.d(t,{W:()=>s,i:()=>r}),function(e){e[e.LeftParen=0]="LeftParen",e[e.True=1]="True",e[e.False=2]="False",e[e.Character=3]="Character",e[e.String=4]="String",e[e.Name=5]="Name",e[e.Keyword=6]="Keyword",e[e.Integer=7]="Integer",e[e.Rational=8]="Rational",e[e.Decimal=9]="Decimal",e[e.Placeholder=10]="Placeholder"}(r||(r={}));class s{constructor(e,t,n){this.type=e,this.text=t,this.sourceSpan=n}}},159:(e,t,n)=>{"use strict";n.d(t,{q2:()=>s,ko:()=>i,Et:()=>a,gc:()=>o,oM:()=>c,$w:()=>u,Nf:()=>l,TT:()=>d});var r=n(794);const s=2,i=s/2,a="white",o=2*Math.PI;function c(e,t){const n=document.createElement("canvas");return n.width=e,n.height=t,[n,n.getContext("2d")]}function u(e,t){let n=(0,r.cU)(t)?Number(t.numerator)/255:1;return(0,r.Vd)(e)?(n*=Number(e.vals[3].numerator)/255,`rgba(${e.vals[0].stringify()}, ${e.vals[1].stringify()}, ${e.vals[2].stringify()}, ${n})`):`rgba(${h.get(e.val).join(", ")}, ${n})`}function l(e){return!(0,r.cU)(e)&&"outline"===e.val}function d(e){return h.has(e.val.toLowerCase())}const h=new Map([["aliceblue",[240,248,255]],["antiquewhite",[250,235,215]],["aqua",[0,255,255]],["azure",[240,255,255]],["beige",[245,245,220]],["bisque",[255,228,196]],["blanchedalmond",[255,235,205]],["blueviolet",[138,43,226]],["burlywood",[222,184,135]],["cadetblue",[95,158,160]],["chartreuse",[127,255,0]],["chocolate",[210,105,30]],["cornflowerblue",[100,149,237]],["cornsilk",[255,248,220]],["crimson",[220,20,60]],["darkblue",[0,0,139]],["darkcyan",[0,139,139]],["darkgoldenrod",[184,134,11]],["darkgray",[169,169,169]],["darkgreen",[0,100,0]],["darkkhaki",[189,183,107]],["darkmagenta",[139,0,139]],["darkolivegreen",[85,107,47]],["darkorange",[255,140,0]],["darkorchid",[153,50,204]],["darkred",[139,0,0]],["darksalmon",[233,150,122]],["darkseagreen",[143,188,139]],["darkslateblue",[72,61,139]],["darkslategray",[47,79,79]],["darkturquoise",[0,206,209]],["darkviolet",[148,0,211]],["deeppink",[255,20,147]],["deepskyblue",[0,191,255]],["dimgray",[105,105,105]],["dodgerblue",[30,144,255]],["floralwhite",[255,250,240]],["forestgreen",[34,139,34]],["fuchsia",[255,0,255]],["gainsboro",[220,220,220]],["ghostwhite",[248,248,255]],["greenyellow",[173,255,47]],["honeydew",[240,255,240]],["hotpink",[255,105,180]],["indianred",[205,92,92]],["indigo",[75,0,130]],["ivory",[255,255,240]],["lavender",[230,230,250]],["lavenderblush",[255,240,245]],["lawngreen",[124,252,0]],["lemonchiffon",[255,250,205]],["lightblue",[173,216,230]],["lightcoral",[240,128,128]],["lightcyan",[224,255,255]],["lightgoldenrodyellow",[250,250,210]],["lightgreen",[144,238,144]],["lightgray",[211,211,211]],["lightpink",[255,182,193]],["lightsalmon",[255,160,122]],["lightseagreen",[32,178,170]],["lightskyblue",[135,206,250]],["lightslategray",[119,136,153]],["lightsteelblue",[176,196,222]],["lightyellow",[255,255,224]],["lime",[0,255,0]],["limegreen",[50,205,50]],["linen",[250,240,230]],["mediumaquamarine",[102,205,170]],["mediumblue",[0,0,205]],["mediumorchid",[186,85,211]],["mediumpurple",[147,112,219]],["mediumseagreen",[60,179,113]],["mediumslateblue",[123,104,238]],["mediumspringgreen",[0,250,154]],["mediumturquoise",[72,209,204]],["mediumvioletred",[199,21,133]],["midnightblue",[25,25,112]],["mintcream",[245,255,250]],["mistyrose",[255,228,225]],["moccasin",[255,228,181]],["navajowhite",[255,222,173]],["oldlace",[253,245,230]],["olive",[128,128,0]],["olivedrab",[107,142,35]],["orangered",[255,69,0]],["palegoldenrod",[238,232,170]],["palegreen",[152,251,152]],["paleturquoise",[175,238,238]],["palevioletred",[219,112,147]],["papayawhip",[255,239,213]],["peachpuff",[255,218,185]],["peru",[205,133,63]],["powderblue",[176,224,230]],["rosybrown",[188,143,143]],["royalblue",[65,105,225]],["saddlebrown",[139,69,19]],["sandybrown",[244,164,96]],["seagreen",[46,139,87]],["seashell",[255,245,238]],["silver",[192,192,192]],["skyblue",[135,206,235]],["slateblue",[106,90,205]],["slategray",[112,128,144]],["snow",[255,250,250]],["springgreen",[0,255,127]],["steelblue",[70,130,180]],["teal",[0,128,128]],["tomato",[255,99,71]],["whitesmoke",[245,245,245]],["yellowgreen",[154,205,50]],["aquamarine",[112,216,144]],["black",[0,0,0]],["blue",[0,0,255]],["blue violet",[138,43,226]],["brown",[132,60,36]],["cadet blue",[96,160,160]],["coral",[255,127,80]],["cornflower blue",[68,64,108]],["cyan",[0,255,255]],["dark gray",[169,169,169]],["dark green",[0,100,0]],["dark olive green",[85,107,47]],["dark orchid",[153,50,204]],["dark slate blue",[72,61,139]],["dark slate gray",[47,79,79]],["dark turquoise",[0,206,209]],["dim gray",[105,105,105]],["firebrick",[178,34,34]],["forest green",[34,139,34]],["gold",[255,215,0]],["goldenrod",[218,165,32]],["gray",[190,190,190]],["green",[0,255,0]],["green yellow",[173,255,47]],["indian red",[205,92,92]],["khaki",[240,230,140]],["light blue",[173,216,230]],["light gray",[211,211,211]],["light steel blue",[176,196,222]],["lime green",[50,205,50]],["magenta",[255,0,255]],["maroon",[176,48,96]],["medium aquamarine",[102,205,170]],["medium blue",[0,0,205]],["medium forest green",[107,142,35]],["mediumforestgreen",[107,142,35]],["medium goldenrod",[234,234,173]],["mediumgoldenrod",[234,234,173]],["medium orchid",[186,85,211]],["medium sea green",[60,179,113]],["medium slate blue",[123,104,238]],["medium spring green",[0,250,154]],["medium turquoise",[72,209,204]],["medium violet red",[199,21,133]],["midnight blue",[25,25,112]],["navy",[36,36,140]],["orange",[255,165,0]],["orange red",[255,69,0]],["orchid",[218,112,214]],["pale green",[152,251,152]],["pink",[255,192,203]],["plum",[221,160,221]],["purple",[160,32,240]],["red",[255,0,0]],["salmon",[250,128,114]],["sea green",[46,139,87]],["sienna",[160,82,45]],["sky blue",[135,206,235]],["slate blue",[106,90,205]],["spring green",[0,255,127]],["steel blue",[70,130,180]],["tan",[210,180,140]],["thistle",[216,191,216]],["turquoise",[64,224,208]],["violet",[238,130,238]],["violet red",[208,32,144]],["violetred",[208,32,144]],["wheat",[245,222,179]],["white",[255,255,255]],["yellow",[255,255,0]],["yellow green",[154,205,50]]])},830:(e,t,n)=>{"use strict";n.d(t,{yC:()=>i,re:()=>a,lB:()=>o,gf:()=>c});var r=n(794),s=n(239);class i extends r.PM{constructor(e){super(),this.canvas=e}stringify(){return"#image"}getType(){return new s.__}equalWithin(e){if(!c(e)||e.canvas.width!==this.canvas.width||e.canvas.height!==this.canvas.height)return!1;const t=this.canvas.getContext("2d").getImageData(0,0,this.canvas.width,this.canvas.height).data,n=e.canvas.getContext("2d").getImageData(0,0,e.canvas.width,e.canvas.height).data;return t.every(((e,t)=>e===n[t]))}}function a(e){return e instanceof i&&0===e.canvas.width&&0===e.canvas.height}function o(e){return(0,r.cU)(e)&&1n===e.denominator&&e.numerator>=0n&&e.numerator<256n}function c(e){return e instanceof i}},239:(e,t,n)=>{"use strict";n.d(t,{Mr:()=>c,e6:()=>u,__:()=>l,XG:()=>d});var r=n(794),s=n(432),i=n(359),a=n(830),o=n(159);class c extends i.Dy{stringify(){return"image-color"}isCompatibleWith(e,t,n){if((0,r.$e)(e)||(0,r.re)(e)){if((0,o.TT)(e))return!0;throw new s.ME(((e,t)=>`${e}: ${t} is not a valid color name`)(t,e.stringify()),n)}return!!((0,r.Vd)(e)&&"color"===e.name&&4===e.vals.length&&(0,a.lB)(e.vals[0])&&(0,a.lB)(e.vals[1])&&(0,a.lB)(e.vals[2])&&(0,a.lB)(e.vals[2]))}isSuperTypeOfHelper(e){return e instanceof c}}class u extends i.Dy{stringify(){return"integer between 0 and 255"}isSuperTypeOfHelper(e,t){return e instanceof u||(0,r.cU)(t)&&1n===t.denominator&&t.numerator>=0&&t.numerator<256}}class l extends i.Dy{isSuperTypeOfHelper(e){return e instanceof l}stringify(){return"image"}}class d extends i.Dy{constructor(){super([new u],[new r.tm("solid"),new r.iN("solid"),new r.tm("outline"),new r.iN("outline")])}stringify(){return"mode"}}},96:(e,t,n)=>{"use strict";n.d(t,{K:()=>m,u:()=>p});var r=n(789),s=n(34),i=n(226),a=n(794),o=n(432),c=n(223),u=n(625),l=n(819),d=n(870),h=n(246);class m{constructor(){this.env=new c.q,this.globalEnv=new c.q,this.execEnv=new c.q,this.testResults=[]}reset(){this.globalEnv=new c.q,this.execEnv=new c.q}run(e){this.testResults=[];const t=e.output;this.env=this.globalEnv;try{t.defns.forEach((e=>{e.accept(this),(0,r.Mf)(e)&&(e.used=!1)}));const e=[];for(const n of t.nodes){let t;(0,r.HF)(n)?(this.env=this.globalEnv,t=n.accept(this)):(this.env=this.execEnv,t=n.accept(this)),t instanceof a.pm?this.testResults.push((0,o.ty)(t.passed,t.msg,t.sourceSpan)):t!==a.dZ&&e.push(t)}return(0,o.mf)(e,[],this.testResults)}catch(e){if(e instanceof o.ME)return(0,o.mf)([],[e],this.testResults);if(e instanceof Error&&"too much recursion"===e.message)return(0,o.mf)([],[new o.ME(s.nT,i.B)],this.testResults);throw e}}visitAndNode(e){e.used=!0;let t=a.Tg;for(const n of e.args)if(t=n.accept(this),(0,a.h8)(t))return t;if(!(0,a.JI)(t))throw new o.ME((0,s.hC)(u.Z.And,t.stringify()),e.sourceSpan);return t}visitAtomNode(e){return e.used=!0,e.rval}visitCheckNode(e){switch(e.used=!0,e.name){case u.Z.CheckExpect:case u.Z.CheckRandom:{let t,n;if(e.name===u.Z.CheckExpect)t=e.args[0].accept(this),n=e.args[1].accept(this);else{const r=(new Date).toString()+(new Date).getMilliseconds();l.i.reset(r),t=e.args[0].accept(this),l.i.reset(r),n=e.args[1].accept(this)}if((0,a.up)(t)||(0,a.up)(n))throw new o.ME((0,s.Iy)(e.name),e.sourceSpan);if((0,a.gX)(t)||(0,a.gX)(n))throw new o.ME((0,s.Cq)(e.name,t.stringify(),n.stringify()),e.sourceSpan);return(0,a.oh)(t)&&t.equal(n)?new a.pm(!0):new a.pm(!1,(0,s.l)(t.stringify(),n.stringify()),e.sourceSpan)}default:throw"illegal state: non-implemented test function"}}visitCheckErrorNode(e){e.used=!0;let t=null;if(e.args[1]&&(t=e.args[1].accept(this),!(0,a.$e)(t)))throw new o.ME((0,s.XM)(t.stringify()),e.args[1].sourceSpan);try{return new a.pm(!1,(0,s.KW)(e.args[0].accept(this).stringify()),e.sourceSpan)}catch(n){if(n instanceof o.ME)return t&&t.val!==n.msg?new a.pm(!1,(0,s.gD)(t.val,n.msg),e.sourceSpan):new a.pm(!0);throw n}}visitCheckMemberOfNode(e){e.used=!0;const t=e.arg.accept(this);return(0,a.h8)(t)?new a.pm(!1,(0,s.bB)(e.testValNode.accept(this).stringify(),e.testAgainstValNodes.map((e=>e.accept(this).stringify()))),e.sourceSpan):new a.pm(!0)}visitCheckRangeNode(e){e.used=!0;const t=e.arg.accept(this);return(0,a.h8)(t)?new a.pm(!1,(0,s.yG)(e.testValNode.accept(this).stringify(),e.lowerBoundValNode.accept(this).stringify(),e.upperBoundValNode.accept(this).stringify()),e.sourceSpan):new a.pm(!0)}visitCheckSatisfiedNode(e){e.used=!0;const t=e.arg.accept(this);return(0,a.JI)(t)?(0,a.h8)(t)?new a.pm(!1,(0,s.R0)(e.testFnName,e.testValNode.accept(this).stringify()),e.sourceSpan):new a.pm(!0):new a.pm(!1,(0,s.$h)(e.testFnName,t.stringify()),e.sourceSpan)}visitCheckWithinNode(e){return e.used=!0,(0,a.h8)(e.arg.accept(this))?new a.pm(!1,(0,s.v_)(e.actualNode.accept(this).stringify(),e.expectedNode.accept(this).stringify(),e.withinNode.accept(this).stringify()),e.sourceSpan):new a.pm(!0)}visitCondNode(e){e.used=!0;for(const[t,n]of e.questionAnswerClauses){const r=t.accept(this);if(!(0,a.JI)(r))throw new o.ME((0,s.hC)(u.Z.Cond,r.stringify()),e.sourceSpan);if(r===a.Xp)return n.accept(this)}throw new o.ME(s.NS,e.sourceSpan)}visitDefnStructNode(e){return e.used=!0,this.env.set(e.name,new a.Bb(e.name)),this.env.set(`make-${e.name}`,new a.Y2(e.name,e.fields.length)),this.env.set(`${e.name}?`,new a.Vq(e.name)),e.fields.forEach(((t,n)=>{this.env.set(`${e.name}-${t}`,new a.If(e.name,t,n))})),a.dZ}visitDefnVarNode(e){return e.used=!0,this.env.set(e.name,e.value.accept(this)),a.dZ}visitEllipsisProcAppNode(e){throw new o.ME((0,s.XK)(e.placeholder.token.text),e.sourceSpan)}visitEllipsisNode(e){throw new o.ME((0,s.XK)(e.placeholder.token.text),e.sourceSpan)}visitIfNode(e){e.used=!0;const t=e.question.accept(this);if(!(0,a.JI)(t))throw new o.ME((0,s.hC)(u.Z.If,t.stringify()),e.sourceSpan);return(0,a.Zb)(t)?e.trueAnswer.accept(this):e.falseAnswer.accept(this)}visitLambdaNode(e){return e.used=!0,new a.bS(e.name,this.env.copy(),e.params,e.body)}visitLetNode(e){switch(e.used=!0,e.bindings.forEach((([e,t])=>{e.used=!0})),e.name){case"letrec":case"let*":case"let":{const t=this.env;this.env=new c.q(this.env),e.bindings.forEach((([e,t])=>{this.env.set(e.name,t.accept(this))}));const n=e.body.accept(this);return this.env=t,n}default:throw"illegal state: unsupported let-style expression"}}visitLocalNode(e){e.used=!0;const t=this.env;this.env=new c.q(this.env),e.defns.forEach((e=>e.accept(this)));const n=e.body.accept(this);return this.env=t,n}visitOrNode(e){e.used=!0;let t=a.Xp;for(const n of e.args)if(t=n.accept(this),t!==a.Tg)break;if(!(0,a.JI)(t))throw new o.ME((0,s.hC)(u.Z.Or,t.stringify()),e.sourceSpan);return t}visitProcAppNode(e){let t;if(e.used=!0,(0,r.Gg)(e.fn)){if(t=this.env.get(e.fn.name,e.fn.sourceSpan),!(0,a.up)(t))throw new o.ME((0,s.y5)((0,a.gB)(t)?`a structure type (do you mean make-${t.name})`:"a variable"),e.fn.sourceSpan)}else t=e.fn.accept(this);if(!(0,a.up)(t))throw new o.ME((0,s.y5)((0,a.gB)(t)?`a structure type (do you mean make-${t.name})`:t.stringify()),e.fn.sourceSpan);try{return t.accept(new p(e.args,this.env,e.sourceSpan))}catch(t){throw t instanceof h.gK?new o.ME(t.message,e.sourceSpan):t}}visitRequireNode(e){e.used=!0;const t=e.global.modules.get(e.name);for(const e of t.procedures)this.env.has(e.getName())||this.env.set(e.getName(),e);for(const[e,n]of t.data)this.env.has(e)||this.env.set(e,n);return a.dZ}visitVarNode(e){return e.used=!0,this.env.get(e.name,e.sourceSpan)}}class p{constructor(e,t,n){this.args=e,this.env=t,this.sourceSpan=n,this.evaluator=new m,this.evaluator.env=t}visitRComposedProcedure(e){let t=e.procedures[0].accept(this);for(const n of e.procedures.slice(1))t=n.accept(new p([new r.RD(t,this.sourceSpan)],this.env,this.sourceSpan));return t}visitRStructHuhProc(e){if(1!==this.args.length)throw new o.ME((0,s.WY)(`${e.name}?`,1,this.args.length),this.sourceSpan);const t=this.args[0].accept(this.evaluator);return t instanceof a.$z&&t.name===e.name?a.Xp:a.Tg}visitRMakeStructFun(e){if(e.arity!==this.args.length)throw new o.ME((0,s.WY)(`make-${e.name}`,e.arity,this.args.length),this.sourceSpan);return new a.$z(e.name,this.args.map((e=>e.accept(this.evaluator))))}visitRLambda(e){const t=new c.q;for(let n=0;n<this.args.length;n++)t.set(e.params[n],this.args[n].accept(this.evaluator));const n=e.closure.copy();n.parentEnv=this.env,t.parentEnv=n;const r=this.evaluator.env;this.evaluator.env=t;const s=e.body.accept(this.evaluator);return this.evaluator.env=r,s}visitRPrimProc(e){const t=this.args.length;if(void 0!==e.config.minArityWithoutLists){if(t<=e.config.minArityWithoutLists)throw new o.ME((0,s.Pd)(e.name),this.sourceSpan)}else if(d.L.primitives.relaxedConditions.includes(e.name)&&void 0!==e.config.relaxedMinArity){if(t<e.config.relaxedMinArity)throw new o.ME((0,s.a1)(e.name,e.config.relaxedMinArity,t),this.sourceSpan)}else if(e.config.minArity&&t<e.config.minArity)throw new o.ME((0,s.a1)(e.name,e.config.minArity,t),this.sourceSpan);const n=e.getType(this.args.length);if(t!==n.paramTypes.length)throw new o.ME((0,s.WY)(e.name,n.paramTypes.length,t),this.sourceSpan);const r=this.args.map((e=>e.accept(this.evaluator)));for(const[t,i]of n.paramTypes.entries()){const a=r[t];if(!i.isCompatibleWith(a,e.name,this.sourceSpan))throw 1===n.paramTypes.length?new o.ME((0,s.R5)(e.name,i.stringify(),a.stringify()),this.sourceSpan):new o.ME((0,s.F6)(e.name,i.stringify(),t,a.stringify()),this.sourceSpan)}return e.call(r,this.sourceSpan,this.env)}visitRStructGetProc(e){if(1!==this.args.length)throw new o.ME((0,s.WY)(`${e.name}-${e.fieldName}`,1,this.args.length),this.sourceSpan);const t=this.args[0].accept(this.evaluator);if(!(t instanceof a.$z)||t.name!=e.name)throw new o.ME((0,s.R5)(`${e.name}-${e.fieldName}`,e.name,t.stringify()),this.sourceSpan);return t.vals[e.idx]}}},246:(e,t,n)=>{"use strict";n.d(t,{Fk:()=>o,yv:()=>a,DA:()=>c,OO:()=>u,_r:()=>l,a_:()=>d,h8:()=>h,b7:()=>m,KY:()=>p,JM:()=>w,gK:()=>i});var r=n(359),s=n(794);class i extends Error{}const a=new s.Rg;class o extends s.em{constructor(){super("=~")}getType(){return new r.B5([new r.sw,new r.sw,new r.Y5],new r.wy)}call(e){return(0,s.K_)(e[0].equalWithin(e[1],e[2].toDecimal()))}}class c extends s.em{constructor(){super("eof-object?")}getType(){return new r.B5([new r.Hs],new r.wy)}call(e){return(0,s.K_)((0,s.HI)(e[0]))}}class u extends s.em{constructor(){super("eq?")}getType(){return new r.B5([new r.Hs,new r.Hs],new r.wy)}call(e){return(0,s.K_)((0,s.oh)(e[0])&&e[0].eq(e[1]))}}class l extends s.em{constructor(){super("equal?")}getType(){return new r.B5([new r.Hs,new r.Hs],new r.wy)}call(e){return(0,s.K_)((0,s.oh)(e[0])&&e[0].equal(e[1]))}}class d extends s.em{constructor(){super("equal~?")}getType(){return new r.B5([new r.Hs,new r.Hs,new r.Y5],new r.wy)}call(e){const t=e[2].toDecimal();return(0,s.K_)((0,s.oh)(e[0])&&e[0].equalWithin(e[1],t))}}class h extends s.em{constructor(){super("eqv?")}getType(){return new r.B5([new r.Hs,new r.Hs],new r.wy)}call(e){return(0,s.K_)((0,s.oh)(e[0])&&e[0].eqv(e[1]))}}class m extends s.em{constructor(){super("error",{})}getType(e){return new r.B5(new Array(e).fill(new r.Hs),new r.NI)}call(e){let t="";for(const n of e)(0,s.$e)(n)?t+=n.val:(0,s.re)(n)?t+=`${n}: `:t+=n.stringify();throw new i(t)}}class p extends s.em{constructor(){super("identity")}getType(){return new r.B5([new r.Hs],new r.Hs)}call(e){return e[0]}}class w extends s.em{constructor(){super("struct?")}getType(){return new r.B5([new r.Hs],new r.wy)}call(e){return(0,s.K_)((0,s.Vd)(e[0]))}}},819:(e,t,n)=>{"use strict";function r(e){let t=1779033703^e.length;for(let n=0;n<e.length;n++)t=Math.imul(t^e.charCodeAt(n),3432918353),t=t<<13|t>>>19;return()=>(t=Math.imul(t^t>>>16,2246822507),t=Math.imul(t^t>>>13,3266489909),(t^=t>>>16)>>>0)}function s(e){return()=>{let t=e+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296}}n.d(t,{i:()=>i});const i=new class{constructor(){this.seed=r((new Date).toString()),this.rng=s(this.seed())}reset(e=this.rng().toString()){this.seed=r(e),this.rng=s(this.seed())}next(){return this.rng()}}},870:(e,t,n)=>{"use strict";n.d(t,{L:()=>a,V:()=>i});var r=n(625),s=n(1);function i(e={}){o(a,e),a.syntax.forms=a.syntax.forms.filter((e=>r.j.includes(e))),a.higherOrderFunctions?(new s.x).enableHigherOrderFunctions():(new s.x).disableHigherOrderFunctions()}const a={higherOrderFunctions:!1,primitives:{blackList:[],relaxedConditions:[]},stringify:{abbreviatedList:!1},syntax:{forms:[...r.j],lambdaExpression:!1,listAbbreviation:!1,quasiquoting:!1}};function o(e,...t){if(!t.length)return e;const n=t.shift();if(c(e)&&c(n))for(const t in n)c(n[t])?(e[t]||Object.assign(e,{[t]:{}}),o(e[t],n[t])):Object.assign(e,{[t]:n[t]});o(e,...t)}function c(e){return e&&"object"==typeof e&&!Array.isArray(e)}},794:(e,t,n)=>{"use strict";n.d(t,{K8:()=>Y,Tg:()=>G,Xp:()=>V,dZ:()=>X,es:()=>d,Ym:()=>h,BC:()=>k,PM:()=>u,Rg:()=>m,pv:()=>v,Af:()=>x,Vq:()=>C,bS:()=>$,zG:()=>T,Y2:()=>S,em:()=>A,tm:()=>p,$z:()=>b,If:()=>B,Bb:()=>w,iN:()=>g,pm:()=>c,JI:()=>P,up:()=>F,oh:()=>N,HI:()=>R,bm:()=>H,cU:()=>M,h8:()=>q,gX:()=>D,Oz:()=>L,Dw:()=>_,LF:()=>W,$e:()=>I,Vd:()=>O,gB:()=>Z,re:()=>K,Zb:()=>U,K_:()=>z});var r=n(359),s=n(226),i=n(870);function a(e,t){return t?a(t,e%t):e}class o{equal(e){return!1}}class c extends o{constructor(e,t="",n=s.B){super(),this.passed=e,this.msg=t,this.sourceSpan=n}stringify(){throw"illegal state: cannot stringify a test result"}getType(){throw"illegal state: should not be asking type of test result"}}class u extends o{equal(e){return this.equalWithin(e,0)}eqv(e){return this.equal(e)}eq(e){return e===this}}class l extends u{}class d extends l{constructor(e){super(),this.val=e}stringify(){return this.val?"#true":"#false"}getType(){return new r.wy}equalWithin(e,t){return P(e)&&e.val===this.val}}class h extends l{constructor(e){super(),this.val=e}stringify(){switch(this.val){case h.NULL_CHAR:return"#\\null";case h.BACKSPACE_CHAR:return"#\\backspace";case h.TAB_CHAR:return"#\\tab";case h.NEWLINE_CHAR:return"#\\newline";case h.VTAB_CHAR:return"#\\vtab";case h.PAGE_CHAR:return"#\\page";case h.RETURN_CHAR:return"#\\return";case h.SPACE_CHAR:return"#\\space";case h.RUBOUT_CHAR:return"#\\rubout"}return`#\\${this.val}`}getType(){return new r.sr}equalWithin(e,t){return function(e){return e instanceof h}(e)&&e.val===this.val}}h.NULL_CHAR=String.fromCharCode(0),h.BACKSPACE_CHAR=String.fromCharCode(8),h.TAB_CHAR=String.fromCharCode(9),h.NEWLINE_CHAR=String.fromCharCode(10),h.VTAB_CHAR=String.fromCharCode(11),h.PAGE_CHAR=String.fromCharCode(12),h.RETURN_CHAR=String.fromCharCode(13),h.SPACE_CHAR=String.fromCharCode(32),h.RUBOUT_CHAR=String.fromCharCode(127);class m extends l{stringify(){return"#<eof>"}getType(){return new r.hJ}equalWithin(e,t){return R(e)}}class p extends l{constructor(e){super(),this.val=e,this.ESCAPED_A=String.fromCharCode(7),this.ESCAPED_B=String.fromCharCode(8),this.ESCAPED_T=String.fromCharCode(9),this.ESCAPED_N=String.fromCharCode(10),this.ESCAPED_V=String.fromCharCode(11),this.ESCAPED_F=String.fromCharCode(12),this.ESCAPED_R=String.fromCharCode(13),this.ESCAPED_E=String.fromCharCode(27)}stringify(){let e="";for(const t of this.val)switch(t){case this.ESCAPED_A:e+="\\a";break;case this.ESCAPED_B:e+="\\b";break;case this.ESCAPED_T:e+="\\t";break;case this.ESCAPED_N:e+="\\n";break;case this.ESCAPED_V:e+="\\v";break;case this.ESCAPED_F:e+="\\f";break;case this.ESCAPED_R:e+="\\r";break;case this.ESCAPED_E:e+="\\e";break;case'"':e+='\\"';break;case"\\":e+="\\\\";break;default:e+=t}return`"${e}"`}getType(){return new r.uW}equalWithin(e,t){return I(e)&&e.val===this.val}}class w extends l{constructor(e){super(),this.name=e}stringify(){return this.name}getType(){return new r.B7(this.name)}equalWithin(e,t){return Z(e)&&e.name===this.name}}class g extends l{constructor(e){super(),this.val=e}stringify(){return this.val.includes("\n")?`'|${this.val}|`:"'"+this.val}getType(){return new r.Ko}equalWithin(e,t){return K(e)&&e.val===this.val}}class f extends l{stringify(){return"(void)"}getType(){return new r.hJ}equalWithin(e,t){return function(e){return e instanceof f}(e)}}class y extends l{constructor(e,t=1n){if(super(),this.numerator=e,this.denominator=t,e<0&&t<0||e>0&&t>0){const n=a(e,t);this.numerator=e/n,this.denominator=t/n}else{const n=a(-1n*e,t);this.numerator=e/n,this.denominator=t/n}}stringify(){if(1n===this.denominator)return this.numerator.toString();if(this.isNegative()){const e=this.numerator/this.denominator;return`${e}${(Number(this.numerator-e*this.denominator)/Number(this.denominator)).toString().slice(2)}`}{const e=this.numerator/this.denominator;return`${e}${(Number(this.numerator-e*this.denominator)/Number(this.denominator)).toString().slice(1)}`}}equalWithin(e,t){return W(e)&&this.within(e,t)}within(e,t){return Math.abs(this.toDecimal()-e.toDecimal())<=t}isPositive(){return this.numerator>0}isZero(){return 0n===this.numerator}isNegative(){return this.numerator<0}toDecimal(){const e=this.numerator/this.denominator;return Number(e)+Number(this.numerator-e*this.denominator)/Number(this.denominator)}}class v extends y{getType(){return 1n===this.denominator?this.numerator>0?new r.NL:0n===this.numerator?new r.D9:new r.Fc:this.numerator>=0?new r.Y5:new r.hZ}equal(e){return M(e)&&e.numerator===this.numerator&&e.denominator===this.denominator}negate(){return new v(-1n*this.numerator,this.denominator)}}class x extends y{stringify(){return`#i${super.stringify()}`}getType(){return 0n===this.denominator?new r.Fc:new r.Ee}equal(e){return W(e)&&e.numerator===this.numerator&&e.denominator===this.denominator}negate(){return new x(-1n*this.numerator,this.denominator)}}class T extends u{constructor(e){super(),this.vals=e}stringify(){if(0===this.vals.length)return"'()";if(i.L.stringify.abbreviatedList)return`(list ${this.vals.map((e=>e.stringify())).join(" ")})`;{let e=`(cons ${this.vals[0].stringify()}`;for(const t of this.vals.slice(1))e+=` (cons ${t.stringify()}`;return e+=" '()"+")".repeat(this.vals.length),e}}getType(){return new r.RH(this.vals.length)}equalWithin(e,t){return _(e)&&e.vals.length===this.vals.length&&e.vals.every(((e,n)=>{const r=this.vals[n];return N(e)&&N(r)&&e.equalWithin(r,t)}))}eqv(e){return e===this}}class b extends u{constructor(e,t){super(),this.name=e,this.vals=t}stringify(){return 0===this.vals.length?`(make-${this.name})`:`(make-${this.name} ${this.vals.map((e=>e.stringify())).join(" ")})`}getType(){return new r.JQ(this.name)}equalWithin(e,t){return O(e)&&e.name===this.name&&e.vals.every(((e,n)=>{const r=this.vals[n];return N(e)&&N(r)&&e.equalWithin(r,t)}))}eqv(e){return e===this}}class E extends o{constructor(e={}){super(),this.config=e}getName(){return"#<procedure>"}}class k extends E{constructor(...e){super(),this.procedures=e}accept(e){return e.visitRComposedProcedure(this)}stringify(){const e=this.procedures[0];return e.config.minArity||e.config.minArityWithoutLists?"(lambda args ...)":`(lambda (${e.getType(-1).paramTypes.map(((e,t)=>`a${t+1}`))}) ...)`}getType(e){return new r.B5(this.procedures[0].getType(e).paramTypes,new r.Hs)}}class C extends E{constructor(e){super(),this.name=e}accept(e){return e.visitRStructHuhProc(this)}stringify(){return this.name}getType(){return new r.B5([new r.Hs],new r.wy)}getName(){return`${this.name}?`}}class S extends E{constructor(e,t){super(),this.name=e,this.arity=t}accept(e){return e.visitRMakeStructFun(this)}stringify(){return this.name}getType(){return new r.B5(new Array(this.arity).fill(new r.Hs),new r.JQ(this.name))}getName(){return`make-${this.name}`}}class $ extends E{constructor(e,t,n,r){super(),this.name=e,this.closure=t,this.params=n,this.body=r}accept(e){return e.visitRLambda(this)}stringify(){return this.name?this.name:`(lambda (${this.params.map(((e,t)=>`a${t+1}`)).join(" ")}) ...)`}getType(){return new r.B5(new Array(this.params.length).fill(new r.Hs),new r.Hs)}}class A extends E{constructor(e,t={}){super(),this.name=e,this.config=t}accept(e){return e.visitRPrimProc(this)}stringify(){return this.name}call(e,t,n){throw"illegal state: not implemented"}getName(){return this.name}}class B extends E{constructor(e,t,n){super(),this.name=e,this.fieldName=t,this.idx=n}accept(e){return e.visitRStructGetProc(this)}stringify(){return`${this.name}-${this.fieldName}`}getType(){return new r.B5([new r.JQ(this.name)],new r.Hs)}getName(){return`${this.name}-${this.fieldName}`}}function P(e){return e instanceof d}function F(e){return e instanceof E}function N(e){return e instanceof u}function R(e){return e instanceof m}function H(e){return _(e)&&0===e.vals.length}function M(e){return e instanceof v}function q(e){return P(e)&&!e.val}function D(e){return e instanceof x}function L(e){return W(e)&&1n===e.denominator}function _(e){return e instanceof T}function W(e){return e instanceof y}function I(e){return e instanceof p}function O(e){return e instanceof b}function Z(e){return e instanceof w}function K(e){return e instanceof g}function U(e){return P(e)&&e.val}function z(e){return e?V:G}const X=new f,V=new d(!0),G=new d(!1),Y=new T([])},359:(e,t,n)=>{"use strict";n.d(t,{wj:()=>a,Hs:()=>i,wy:()=>o,sr:()=>c,NI:()=>u,D9:()=>l,NL:()=>d,Fc:()=>h,RH:()=>m,Y5:()=>p,sw:()=>w,hE:()=>g,FJ:()=>f,B5:()=>y,Ee:()=>v,hZ:()=>x,uW:()=>T,JQ:()=>b,B7:()=>E,Ko:()=>k,Dy:()=>s,hJ:()=>C,xW:()=>S});var r=n(794);class s{constructor(e=[],t=[]){this.children=e,this.literals=t}isCompatibleWith(e,t,n){return this.isSuperTypeOf(e.getType(-1),e)}isSuperTypeOf(e,t){return e instanceof this.constructor||this.children.some((n=>n.isSuperTypeOf(e,t)))||this.literals.some((e=>e.equal(t)))}}class i extends s{stringify(){return"any/c"}isCompatibleWith(){return!0}isSuperTypeOf(){return!0}}class a extends s{stringify(){return"procedure"}isCompatibleWith(e){return(0,r.up)(e)}isSuperTypeOf(e){return e instanceof a||e instanceof y}}class o extends s{stringify(){return"boolean"}}class c extends s{stringify(){return"character"}}class u extends s{stringify(){return"error"}}class l extends s{constructor(){super([new d])}stringify(){return"exact-non-negative-integer"}}class d extends s{stringify(){return"exact-positive-integer"}}class h extends s{constructor(){super([new l])}stringify(){return"integer"}}class m extends s{constructor(e=0){super(),this.minLength=e}stringify(){return 0===this.minLength?"list":1===this.minLength?"non-empty list":`list with ${this.minLength} or more elements`}isSuperTypeOf(e){return e instanceof m&&e.minLength>=this.minLength||0===this.minLength&&e instanceof f}}class p extends s{constructor(){super([new l])}stringify(){return"non-negative-real"}}class w extends s{constructor(){super([new x])}stringify(){return"number"}}class g extends s{constructor(e,t){super(e,t)}stringify(){return`(or/c ${this.children.map((e=>e.stringify())).join(" ")})`}}class f extends s{isSuperTypeOf(e){return e instanceof f||e instanceof m}stringify(){return"pair"}}class y extends s{constructor(e,t){super(),this.paramTypes=e,this.outputType=t}isSuperTypeOf(e,t){return e instanceof y&&e.paramTypes.length===this.paramTypes.length&&this.paramTypes.every(((n,r)=>n.isSuperTypeOf(e.paramTypes[r],t)))&&this.outputType.isSuperTypeOf(e.outputType,t)}isCompatibleWith(e){if(!(0,r.up)(e))return!1;const t=e.getType(this.paramTypes.length);return t.paramTypes.length===this.paramTypes.length&&this.paramTypes.every(((n,r)=>n.isSuperTypeOf(t.paramTypes[r],e)||t.paramTypes[r].isSuperTypeOf(n,e)))&&(this.outputType.isSuperTypeOf(t.outputType,e)||t.outputType.isSuperTypeOf(this.outputType,e))}stringify(){return`(${this.paramTypes.map((e=>e.stringify())).join(" ")} . -> . ${this.outputType.stringify()})`}}class v extends s{constructor(){super([new h])}stringify(){return"rational"}}class x extends s{constructor(){super([new p,new v])}stringify(){return"real"}}class T extends s{stringify(){return"string"}}class b extends s{constructor(e){super(),this.name=e}stringify(){return"illegal state: should not have to stringify a structure type"}isSuperTypeOf(e){return e instanceof b&&e.name===this.name}}class E extends s{constructor(e){super(),this.name=e}stringify(){return this.name}isSuperTypeOf(e){return e instanceof E&&e.name===this.name}}class k extends s{stringify(){return"string"}}class C extends s{stringify(){return"void"}}function S(e){return e instanceof y}},906:()=>{document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".resizer").forEach((function(e){!function(e){const t=e.getAttribute("data-direction"),n=e.previousElementSibling,r=e.nextElementSibling;let s=0,i=0,a=0,o=0;const c=function(c){const u=c.clientX-s,l=c.clientY-i;switch(t){case"vertical":{const t=100*(a+l)/e.parentNode.getBoundingClientRect().height;n.style.height=`${t}%`,r.style.maxHeight=100-t+"%";break}case"horizontal":{const t=100*(o+u)/e.parentNode.getBoundingClientRect().width;n.style.width=`${t}%`,r.style.maxWidth=100-t+"%";break}}const d="horizontal"===t?"col-resize":"row-resize";e.style.cursor=d,document.body.style.cursor=d,n.style.userSelect="none",n.style.pointerEvents="none",r.style.userSelect="none",r.style.pointerEvents="none"},u=function(){e.style.removeProperty("cursor"),document.body.style.removeProperty("cursor"),n.style.removeProperty("user-select"),n.style.removeProperty("pointer-events"),r.style.removeProperty("user-select"),r.style.removeProperty("pointer-events"),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",u)};e.addEventListener("mousedown",(function(e){s=e.clientX,i=e.clientY;const t=n.getBoundingClientRect();a=t.height,o=t.width,document.addEventListener("mousemove",c),document.addEventListener("mouseup",u)}))}(e)}))})),document.addEventListener("keydown",(function(e){"s"===e.key&&e.ctrlKey&&e.preventDefault()}),!1)}},e=>{e(e.s=410)}]);